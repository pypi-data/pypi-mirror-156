(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[877],{4768:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/app/settings",function(){return n(1206)}])},6771:function(e,t,n){"use strict";n.d(t,{Z:function(){return w}});var i=n(5893),r=n(7294),o=n(1163),a=n(9008),s=n.n(a),c=n(8298),l=n(2734),u=n(2293),d=n(9520),p=n(155),f=n(6886),h=n(3321),y=n(5861),g=n(7357);function m(e){var t=e.children,n=(0,c.Z)({disableHysteresis:!0,threshold:24});return(0,r.cloneElement)(t,{elevation:n?4:0})}var v=function(){var e=(0,r.useState)(!1),t=e[0],n=e[1],o=((0,r.useCallback)((function(){n(!t)}),[t]),(0,l.Z)());return(0,i.jsx)(i.Fragment,{children:(0,i.jsx)(m,{children:(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(u.Z,{color:"transparent",elevation:0,children:(0,i.jsx)(d.Z,{maxWidth:"xl",sx:{padding:0},children:(0,i.jsx)(p.Z,{sx:{minHeight:50,maxHeight:50,padding:0,flex:1,alignItems:"center",justifyContent:"space-between",display:"flex",flexWrap:"nowrap"},children:(0,i.jsx)(f.ZP,{item:!0,children:(0,i.jsx)(h.Z,{href:"https://system-bridge.timmo.dev",target:"_blank",children:(0,i.jsx)(y.Z,{component:"div",variant:"h4",sx:{textTransform:"none",userSelect:"none",color:o.palette.primary.contrastText},children:"System Bridge"})})})})})}),(0,i.jsx)(g.Z,{sx:{height:o.spacing(18)}})]})})})};function x(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function b(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},i=Object.keys(n);"function"===typeof Object.getOwnPropertySymbols&&(i=i.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),i.forEach((function(t){x(e,t,n[t])}))}return e}var j=!1;var w=function(e){var t=(0,o.useRouter)();return(0,r.useEffect)((function(){if(t.isReady&&!j){var e,n,i,r;j=!0;var o=(null===(e=t.query)||void 0===e?void 0:e.apiKey)||"",a=(null===(n=t.query)||void 0===n?void 0:n.apiPort)||"9170",s=!1;if((null===(i=t.query)||void 0===i?void 0:i.apiKey)||(s=!0,o=window.prompt("Please enter your API key",o)),(null===(r=t.query)||void 0===r?void 0:r.apiPort)||(s=!0,a=window.prompt("Please enter your API port (default: 9170)",a)),s&&o&&a){var c=t.asPath.split("?")[0];t.replace({pathname:c.includes(".html")?c:"".concat(c,".html"),query:b({},t.query,{apiKey:o,apiPort:a})})}}}),[t]),(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(s(),{children:[(0,i.jsx)("title",{children:e.title?"".concat(e.title," - System Bridge"):"System Bridge"}),(0,i.jsx)("link",{rel:"canonical",href:e.url}),(0,i.jsx)("meta",{name:"description",content:e.description?"".concat(e.description):e.title?"".concat(e.title," - System Bridge"):"System Bridge"}),(0,i.jsx)("meta",{name:"keywords",content:e.keywords?"".concat(e.keywords):"system-bridge, system, bridge, typescript"})]}),!e.noHeader&&(0,i.jsx)(v,{}),e.children]})}},6317:function(e,t,n){"use strict";n.d(t,{D:function(){return o},X:function(){return r}});var i=n(7294);function r(e){navigator.permissions.query({name:"clipboard-write"}).then((function(t){"granted"!==t.state&&"prompt"!==t.state||navigator.clipboard.writeText(e)}))}function o(e){var t=(0,i.useRef)();return(0,i.useEffect)((function(){t.current=e})),t.current}},9375:function(e,t,n){"use strict";n.d(t,{C:function(){return s}});var i=n(4051),r=n.n(i);function o(e,t,n,i,r,o,a){try{var s=e[o](a),c=s.value}catch(l){return void n(l)}s.done?t(c):Promise.resolve(c).then(i,r)}function a(e){return function(){var t=this,n=arguments;return new Promise((function(i,r){var a=e.apply(t,n);function s(e){o(a,i,r,s,c,"next",e)}function c(e){o(a,i,r,s,c,"throw",e)}s(void 0)}))}}var s=function(){function e(t,n,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.port=t||9170,this.apiKey=n;var o=this;a(r().mark((function e(){return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o.connect();case 2:o.websocket=e.sent,i&&o.websocket&&o.websocket.readyState===o.websocket.OPEN&&i();case 4:case"end":return e.stop()}}),e)})))()}var t=e.prototype;return t.close=function(){this.websocket&&this.websocket.readyState===this.websocket.OPEN&&this.websocket.close()},t.connect=function(){var e=this;return a(r().mark((function t(){var n;return r().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=new WebSocket("ws://".concat(window.location.hostname||"localhost",":").concat(e.port,"/api/websocket")),t.next=3,new Promise((function(e){n.onopen=function(){return e()}}));case 3:return n.onmessage=function(t){if("string"===typeof t.data){var n=JSON.parse(t.data);n&&e.onEvent&&e.onEvent(n)}},t.abrupt("return",n);case 5:case"end":return t.stop()}}),t)})))()},t.isConnected=function(){var e;return(null===(e=this.websocket)||void 0===e?void 0:e.readyState)===WebSocket.OPEN},t.getData=function(e){this.websocket&&this.websocket.readyState===this.websocket.OPEN&&(console.log("Get data:",e),this.websocket.send(JSON.stringify({"api-key":this.apiKey,event:"GET_DATA",modules:e})))},t.getSettings=function(){this.websocket&&this.websocket.readyState===this.websocket.OPEN&&(console.log("Get settings"),this.websocket.send(JSON.stringify({"api-key":this.apiKey,event:"GET_SETTINGS"})))},t.registerDataListener=function(e){this.websocket&&this.websocket.readyState===this.websocket.OPEN&&(console.log("Register data listener:",e),this.websocket.send(JSON.stringify({"api-key":this.apiKey,event:"REGISTER_DATA_LISTENER",modules:e})))},t.sendPlayerStatus=function(e){this.websocket&&this.websocket.readyState===this.websocket.OPEN&&this.websocket.send(JSON.stringify({"api-key":this.apiKey,event:"MEDIA_STATUS",status:e}))},t.updateSetting=function(e,t){this.websocket&&this.websocket.readyState===this.websocket.OPEN&&(console.log("Update setting:",{key:e,value:t}),this.websocket.send(JSON.stringify({"api-key":this.apiKey,event:"UPDATE_SETTING",setting:e,value:t})))},e}()},1206:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return ee}});var i=n(5893),r=n(7294),o=n(9520),a=n(6771),s=n(4051),c=n.n(s),l=n(2734),u=n(6886),d=n(8456),p=n(1163),f=n(5317),h=n(7262),y=n(9375),g=n(5934),m=n(8619),v=n(9294),x=n(796),b=n(9953),j=n(3395),w=n(9653),k=n(4054),S=n(7709),Z=n(7109),P=n(3946),O=n(1713),C=n(699),E=n(8849),I=n(6317),A=n(8396),N=n(657),T=n(7645),_=n(8951),D=n(6514),R=n(8462),W=n(1425),G=n(3321),z=n(6486),K=n.n(z);var q=function(e){var t=e.setting,n=e.listIn,o=e.open,a=e.setOpen,s=e.handleChanged,c=(0,r.useState)([]),d=c[0],p=c[1],h=t.name,y=t.description,g=t.icon;(0,r.useEffect)((function(){!o&&n&&p(n)}),[n,o]);var j=(0,l.Z)(),w=(0,A.Z)(j.breakpoints.down("md"));return(0,i.jsxs)(N.Z,{fullScreen:w,fullWidth:!0,maxWidth:"lg",open:o,scroll:"paper",PaperProps:{style:{background:j.palette.background.paper}},children:[(0,i.jsxs)(T.Z,{children:[(0,i.jsx)(E.Icon,{id:"copy-to-clipboard",title:"Copy to clipboard",size:.7,path:g,style:{marginRight:j.spacing(1)}}),h]}),(0,i.jsx)(_.Z,{sx:{margin:j.spacing(0,3)},children:y}),(0,i.jsx)(D.Z,{children:(0,i.jsxs)(R.Z,{children:[d.map((function(e,t){return(0,i.jsx)(v.ZP,{children:(0,i.jsxs)(u.ZP,{container:!0,alignItems:"center",children:[(0,i.jsx)(u.ZP,{item:!0,xs:4,sx:{marginRight:j.spacing(1)},children:(0,i.jsx)(C.Z,{id:"name",label:"Name",fullWidth:!0,variant:"outlined",value:e.name,onChange:function(e){var n=K().cloneDeep(d);console.log("Update name:",t,n,n[t]),n&&n[t]&&(n[t].name=e.target.value,p(n))}})}),(0,i.jsx)(u.ZP,{item:!0,xs:!0,sx:{marginLeft:j.spacing(1)},children:(0,i.jsx)(C.Z,{id:"value",label:"Value",fullWidth:!0,variant:"outlined",value:e.value,onChange:function(e){var n=K().cloneDeep(d);console.log("Update value:",t,n,n[t]),n&&n[t]&&(n[t].value=e.target.value,p(n))}})}),(0,i.jsx)(u.ZP,{item:!0,children:(0,i.jsx)(P.Z,{"aria-label":"Remove",size:"large",onClick:function(){var e=K().cloneDeep(d);e.splice(t,1),p(e)},children:(0,i.jsx)(E.Icon,{id:"remove-item",title:"Remove",size:.8,path:f.S6N})})})]})},t)})),(0,i.jsxs)(m.Z,{onClick:function(){var e=K().cloneDeep(d);e.push({name:"",value:""}),p(e)},children:[(0,i.jsx)(x.Z,{children:(0,i.jsx)(E.Icon,{id:"add",title:"Add",size:1,path:f.qX5})}),(0,i.jsx)(b.Z,{primary:"Add",secondary:"Add a new item"})]})]})}),(0,i.jsxs)(W.Z,{children:[(0,i.jsx)(G.Z,{onClick:function(){a(!1)},color:"primary",variant:"outlined",children:"Cancel"}),(0,i.jsx)(G.Z,{onClick:function(){a(!1),s(d.sort((function(e,t){return e.name.localeCompare(t.name)})))},color:"primary",variant:"outlined",children:"Save"})]})]})};function L(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var F=function(e){var t=e.keyIn,n=e.valueIn,o=e.handleChanged,a=function(e){_(e)},s=function(e){a(e.target.value)},c=(0,r.useState)(!1),d=c[0],p=c[1],h=(0,r.useState)(!1),y=h[0],A=h[1],N=(0,r.useState)(n),T=N[0],_=N[1],D=(0,r.useMemo)((function(){return n!==T}),[n,T]),R=Q[t],W=R.name,G=R.description,z=R.icon,K=R.containerDisabled,F=R.isList,U=R.isPassword,B=R.minimum,J=(0,l.Z)(),M=function(e){var t=e.children;return F?(0,i.jsx)(m.Z,{onClick:function(){return p(!0)},children:t}):(0,i.jsx)(v.ZP,{children:t})};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(M,{children:(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(x.Z,{children:(0,i.jsx)(E.Icon,{id:"icon",title:W,size:1,path:z})}),(0,i.jsx)(b.Z,{primary:W,secondary:G,sx:{maxWidth:"64%",userSelect:"none"}}),(0,i.jsx)(j.Z,{sx:{width:420,textAlign:"end"},children:(0,i.jsxs)(u.ZP,{container:!0,alignItems:"center",justifyContent:"flex-end",children:[(0,i.jsx)(u.ZP,{item:!0,children:"boolean"===typeof T?(0,i.jsx)(w.Z,{edge:"end",disabled:K,checked:T,onChange:function(e,t){a(t)}}):"string"===typeof n&&"api_key"===t?(0,i.jsx)(k.Z,{fullWidth:!0,variant:"outlined",children:(0,i.jsx)(S.Z,{type:"text",disabled:!0,value:T,endAdornment:(0,i.jsxs)(Z.Z,{position:"end",children:[(0,i.jsx)(P.Z,{"aria-label":"Generate Api Key",onClick:function(){a((0,g.Z)())},edge:"end",size:"large",sx:{margin:J.spacing(-1,-.5)},children:(0,i.jsx)(E.Icon,{id:"generate-api-key",title:"Generate API Key",size:1,path:f.VmU})}),(0,i.jsx)(P.Z,{"aria-label":"Copy to clipboard",onClick:function(){return(0,I.X)(String(T))},size:"large",sx:{margin:J.spacing(-1,-.5)},children:(0,i.jsx)(E.Icon,{id:"copy-to-clipboard",title:"Copy to clipboard",size:.8,path:f.a0Z})})]})})}):"string"===typeof n&&"string"===typeof T&&"log_level"===t?(0,i.jsx)(O.Z,{id:t,options:["DEBUG","INFO","WARNING","ERROR","CRITICAL"],renderInput:function(e){return(0,i.jsx)(C.Z,function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},i=Object.keys(n);"function"===typeof Object.getOwnPropertySymbols&&(i=i.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),i.forEach((function(t){L(e,t,n[t])}))}return e}({},e,{variant:"outlined"}))},onChange:function(e,t){t&&a(t)},sx:{width:210},value:T}):"string"===typeof n&&U?(0,i.jsx)(k.Z,{variant:"outlined",children:(0,i.jsx)(S.Z,{type:y?"text":"password",defaultValue:T,onChange:s,endAdornment:(0,i.jsx)(Z.Z,{position:"end",children:(0,i.jsx)(P.Z,{"aria-label":"Toggle visibility",onClick:function(){A(!y)},onMouseDown:function(e){e.preventDefault()},size:"large",children:(0,i.jsx)(E.Icon,{id:"copy-to-clipboard",title:"Copy to clipboard",size:.8,path:y?f.rgx:f.DqW})})})})}):"string"===typeof n?(0,i.jsx)(C.Z,{type:"text",defaultValue:T,disabled:K,onChange:s,variant:"outlined"}):"number"===typeof n?(0,i.jsx)(C.Z,{error:!!B&&Number(T)<B,type:"number",disabled:K,inputProps:{minimum:B},defaultValue:T,onChange:s,variant:"outlined"}):""}),F?"":(0,i.jsx)(u.ZP,{item:!0,children:(0,i.jsx)(P.Z,{disabled:!1===D,onClick:function(){o(t,T)},sx:{margin:J.spacing(1)},children:(0,i.jsx)(E.Icon,{id:"save",title:"Save",size:1,path:f.JTj,style:{opacity:D?1:.25}})})})]})})]})}),F&&Array.isArray(T)?(0,i.jsx)(i.Fragment,{children:(0,i.jsx)(q,{setting:Q[t],listIn:T,open:d,setOpen:p,handleChanged:function(e){_(e),o(t,e)}})}):""]})},U=n(5861),B=n(5113);var J,M=function(e){var t=e.name,n=e.description,r=e.children;return(0,i.jsxs)(u.ZP,{container:!0,direction:"row",item:!0,xs:12,children:[(0,i.jsxs)(u.ZP,{item:!0,xs:4,style:{userSelect:"none"},children:[(0,i.jsx)(U.Z,{component:"h3",variant:"h5",children:t}),(0,i.jsx)(U.Z,{variant:"subtitle1",children:n})]}),(0,i.jsx)(u.ZP,{item:!0,xs:8,children:(0,i.jsx)(B.Z,{children:(0,i.jsx)(R.Z,{children:r})})})]})};function V(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function X(e,t,n,i,r,o,a){try{var s=e[o](a),c=s.value}catch(l){return void n(l)}s.done?t(c):Promise.resolve(c).then(i,r)}function H(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function $(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var i,r,o=[],a=!0,s=!1;try{for(n=n.call(e);!(a=(i=n.next()).done)&&(o.push(i.value),!t||o.length!==t);a=!0);}catch(c){s=!0,r=c}finally{try{a||null==n.return||n.return()}finally{if(s)throw r}}return o}}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return V(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return V(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var Q={autostart:{name:"Autostart",description:"Automatically start the application on startup",icon:f.USr},log_level:{name:"Log Level",description:"Log level for the application",icon:f.eLz},port_api:{name:"API Port",description:"Port for the API and WebSocket",icon:f.A0p},additional_media_directories:{name:"Additional Media Directories",description:"Additional media directories for the media endpoint",icon:f.Rmq,isList:!0}};var Y=function(){var e=$((0,h.r)(),2),t=e[0],n=e[1],o=(0,r.useState)(!1),a=o[0],s=o[1],f=(0,p.useRouter)().query,g=(0,r.useCallback)((function(e){if(console.log("Event:",e),"SETTINGS_RESULT"===e.type){console.log("Settings result data:",e.data);var t={};console.log("settingsMap:",Q);var i=Object.keys(Q);e.data.sort((function(e,t){return i.indexOf(e.key)>i.indexOf(t.key)?1:-1})).forEach((function(e){t[e.key]=e.value})),console.log("Settings:",t),n(t)}}),[n]),m=(0,r.useCallback)((function(e,t){var n;console.log("Setup WebSocketConnection"),J=new y.C(e,t,(n=c().mark((function e(){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:J.getSettings();case 1:case"end":return e.stop()}}),e)})),function(){var e=this,t=arguments;return new Promise((function(i,r){var o=n.apply(e,t);function a(e){X(o,i,r,a,s,"next",e)}function s(e){X(o,i,r,a,s,"throw",e)}a(void 0)}))})),J.onEvent=g}),[g]),v=(0,r.useCallback)((function(e,i){J.updateSetting(e,i),n(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},i=Object.keys(n);"function"===typeof Object.getOwnPropertySymbols&&(i=i.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),i.forEach((function(t){H(e,t,n[t])}))}return e}({},t,H({},e,i)))}),[t,n]);(0,r.useEffect)((function(){!a&&f&&f.apiKey&&(s(!0),m(Number(f.apiPort)||9170,String(f.apiKey)))}),[a,m,f]);var x=(0,l.Z)();return(0,i.jsx)(i.Fragment,{children:(0,i.jsx)(u.ZP,{container:!0,direction:"column",spacing:2,alignItems:"stretch",sx:{marginBottom:x.spacing(8),padding:x.spacing(2)},children:t?(0,i.jsx)(M,{name:"General",description:"General settings",children:(0,i.jsx)(i.Fragment,{children:Object.keys(t).map((function(e,n){return(0,i.jsx)(F,{keyIn:e,valueIn:t[e],handleChanged:v},n)}))})}):(0,i.jsx)(u.ZP,{container:!0,direction:"row",justifyContent:"center",sx:{margin:x.spacing(2,0,10)},children:(0,i.jsx)(d.Z,{})})})})};var ee=function(){return(0,i.jsx)(a.Z,{title:"Settings",url:"https://system-bridge.timmo.dev",description:"Frontend for System Bridge",children:(0,i.jsx)(o.Z,{component:"article",maxWidth:"xl",children:(0,i.jsx)(Y,{})})})}}},function(e){e.O(0,[662,702,291,91,316,699,713,767,208,774,888,179],(function(){return t=4768,e(e.s=t);var t}));var t=e.O();_N_E=t}]);