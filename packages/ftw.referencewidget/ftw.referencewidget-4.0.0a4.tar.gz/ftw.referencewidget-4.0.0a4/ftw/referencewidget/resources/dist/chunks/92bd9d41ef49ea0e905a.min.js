"use strict";(self.webpackChunksimplelayout=self.webpackChunksimplelayout||[]).push([[612],{4612:(e,t,a)=>{a.r(t);var r=a(8161);const s={ref:"root"},l={class:"widget-selected-items"},o={class:"list-group"},i=["name","value"],c=["data-bs-target"],n=["id"],d={class:"modal-dialog modal-dialog-scrollable modal-xl"},m={class:"modal-content"},p=(0,r.createElementVNode)("div",{class:"modal-header"},"Choose content",-1),h={class:"modal-body"},u=(0,r.createElementVNode)("div",{class:"modal-footer"},[(0,r.createElementVNode)("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"}," Close ")],-1);const b={key:0,"aria-label":"Pagination for this listing"},f={class:"pagination"};const g={props:{batching:{type:Object,required:!0,default:()=>null}},methods:{triggerNext(){this.$emit("next",this.batching.next)},triggerPrevious(){this.$emit("previous",this.batching.prev)}}};var y=a(3744);const v=(0,y.Z)(g,[["render",function(e,t,a,s,l,o){return a.batching?((0,r.openBlock)(),(0,r.createElementBlock)("nav",b,[(0,r.createElementVNode)("ul",f,[(0,r.createElementVNode)("li",{class:(0,r.normalizeClass)(a.batching.prev?"page-item":"page-item disabled")},[(0,r.createElementVNode)("a",{href:"#",onClick:t[0]||(t[0]=(0,r.withModifiers)(((...e)=>o.triggerPrevious&&o.triggerPrevious(...e)),["prevent"])),class:"page-link"}," Previous ")],2),(0,r.createElementVNode)("li",{class:(0,r.normalizeClass)(a.batching.next?"page-item":"page-item disabled")},[(0,r.createElementVNode)("a",{href:"#",onClick:t[1]||(t[1]=(0,r.withModifiers)(((...e)=>o.triggerNext&&o.triggerNext(...e)),["prevent"])),class:"page-link"}," Next ")],2)])])):(0,r.createCommentVNode)("v-if",!0)}]]),k={class:"col"},E={class:"form-floating"},N=["selected","value"],V=(0,r.createElementVNode)("label",{for:"sortattr"},"Sort on",-1),D={class:"col"},B={class:"form-floating"},T=[(0,r.createElementVNode)("option",{selected:"",value:"ascending"},"Ascending",-1),(0,r.createElementVNode)("option",{selected:"",value:"descending"},"Descending",-1)],S=(0,r.createElementVNode)("label",{for:"sortorder"},"Sort order",-1),x={class:"col"},O={class:"form-floating"},C=(0,r.createElementVNode)("label",{for:"searchFilter"},"Search",-1),P={class:"col"},L=(0,r.createElementVNode)("button",{type:"submit",class:"btn btn-primary"},"Search",-1);const w={data:()=>({searchTerm:"",sortOn:"getObjPositionInParent",sortOrder:"ascending",sortAttribute:[{title:"Position",value:"getObjPositionInParent"},{title:"Title",value:"sortable_title"},{title:"Created",value:"created"},{title:"Modified",value:"modified"}]}),methods:{search(){this.$emit("search",{searchTerm:this.searchTerm,sortOn:this.sortOn,sortOrder:this.sortOrder})},reset(){this.$emit("reset",{searchTerm:"",sortOn:"getObjPositionInParent",sortOrder:"ascending"})}}},U=(0,y.Z)(w,[["render",function(e,t,a,s,l,o){return(0,r.openBlock)(),(0,r.createElementBlock)("form",{onSubmit:t[6]||(t[6]=(0,r.withModifiers)(((...e)=>o.search&&o.search(...e)),["stop","prevent"])),class:"row my-2 gy-2 gx-3 align-items-center"},[(0,r.createElementVNode)("div",k,[(0,r.createElementVNode)("div",E,[(0,r.withDirectives)((0,r.createElementVNode)("select",{class:"form-select",id:"sortattr","aria-label":"Sort attribute","onUpdate:modelValue":t[0]||(t[0]=e=>l.sortOn=e),onChange:t[1]||(t[1]=()=>o.search())},[((0,r.openBlock)(!0),(0,r.createElementBlock)(r.Fragment,null,(0,r.renderList)(l.sortAttribute,((e,t)=>((0,r.openBlock)(),(0,r.createElementBlock)("option",{key:e.value,selected:0==t,value:e.value},(0,r.toDisplayString)(e.title),9,N)))),128))],544),[[r.vModelSelect,l.sortOn]]),V])]),(0,r.createElementVNode)("div",D,[(0,r.createElementVNode)("div",B,[(0,r.withDirectives)((0,r.createElementVNode)("select",{class:"form-select",id:"sortorder","aria-label":"Sort order","onUpdate:modelValue":t[2]||(t[2]=e=>l.sortOrder=e),onChange:t[3]||(t[3]=()=>o.search())},T,544),[[r.vModelSelect,l.sortOrder]]),S])]),(0,r.createElementVNode)("div",x,[(0,r.createElementVNode)("div",O,[(0,r.withDirectives)((0,r.createElementVNode)("input",{type:"text",class:"form-control",id:"searchFilter",placeholder:"Text","onUpdate:modelValue":t[4]||(t[4]=e=>l.searchTerm=e)},null,512),[[r.vModelText,l.searchTerm]]),C])]),(0,r.createElementVNode)("div",P,[L,(0,r.createElementVNode)("button",{onClick:t[5]||(t[5]=(0,r.withModifiers)(((...e)=>o.reset&&o.reset(...e)),["stop","prevent"])),class:"btn btn-danger"}," Reset ")])],32)}]]),A={"aria-label":"breadcrumb"},R={class:"breadcrumb"},_={class:"breadcrumb-item"},I=["href"],q={key:0,class:"breadcrumb-item"},F=["href","onClick"],M={key:1,class:"breadcrumb-item active","aria-current":"page"};const $={props:{breadcrumbs:{type:Array,required:!0,default:()=>[]},portalURL:{type:String,required:!0,default:()=>""},fetchData:{type:Function,required:!0,default:()=>null}}},j=(0,y.Z)($,[["render",function(e,t,a,s,l,o){return(0,r.openBlock)(),(0,r.createElementBlock)("nav",A,[(0,r.createElementVNode)("ol",R,[(0,r.createElementVNode)("li",_,[(0,r.createElementVNode)("a",{href:a.portalURL,onClick:t[0]||(t[0]=(0,r.withModifiers)((e=>a.fetchData(a.portalURL)),["prevent","stop"]))},"Startpage",8,I)]),((0,r.openBlock)(!0),(0,r.createElementBlock)(r.Fragment,null,(0,r.renderList)(a.breadcrumbs,((e,t)=>((0,r.openBlock)(),(0,r.createElementBlock)(r.Fragment,{key:e["@id0"]},[t!=a.breadcrumbs.length-1?((0,r.openBlock)(),(0,r.createElementBlock)("li",q,[(0,r.createElementVNode)("a",{href:e["@id"],onClick:(0,r.withModifiers)((t=>a.fetchData(e["@id"])),["stop","prevent"])},(0,r.toDisplayString)(e.title),9,F)])):((0,r.openBlock)(),(0,r.createElementBlock)("li",M,(0,r.toDisplayString)(e.title),1))],64)))),128))])])}]]),Z={class:"list-group"},z={class:"form-check"},J=["type","value","checked","selected","disabled"],W={class:"form-check-label"},G=["onClick","href"],H={key:1};const K={data:()=>({selected:[]}),props:{items:{type:Array,required:!0,default:()=>[]},selectedItems:{type:Array,required:!0,default:()=>[]},inputType:{type:String,required:!0,default:()=>"checkbox"},selectableTypes:{type:Array,required:!0,default:()=>[]},traversableTypes:{type:Array,required:!0,default:()=>[]},fetchData:{type:Function,required:!0,default:()=>null}},mounted(){this.selected=this.selectedItems},methods:{checked(){this.$emit("checked",this.selected)}},computed:{selectedProxy:{get(){return this.selected},set(e){"checkbox"==this.inputType?this.selected=e:this.selected=[e]}}}},Q=(0,y.Z)(K,[["render",function(e,t,a,s,l,o){return(0,r.openBlock)(),(0,r.createElementBlock)("ul",Z,[((0,r.openBlock)(!0),(0,r.createElementBlock)(r.Fragment,null,(0,r.renderList)(a.items,(e=>((0,r.openBlock)(),(0,r.createElementBlock)("li",{key:e.UID,class:"list-group-item"},[(0,r.createElementVNode)("div",z,[(0,r.withDirectives)((0,r.createElementVNode)("input",{class:"form-check-input me-1",type:a.inputType,value:e["@id"],checked:e["@id"]in o.selectedProxy,selected:e["@id"]in o.selectedProxy,"onUpdate:modelValue":t[0]||(t[0]=e=>o.selectedProxy=e),onChange:t[1]||(t[1]=(...e)=>o.checked&&o.checked(...e)),disabled:-1==a.selectableTypes.indexOf(e.portal_type)},null,40,J),[[r.vModelDynamic,o.selectedProxy]]),(0,r.createElementVNode)("label",W,[e.is_folderish&&-1!=a.traversableTypes.indexOf(e.portal_type)?((0,r.openBlock)(),(0,r.createElementBlock)("a",{key:0,onClick:(0,r.withModifiers)((t=>a.fetchData(e["@id"])),["prevent","stop"]),href:e["@id"],class:"list-group-item-action"},(0,r.toDisplayString)(e.title),9,G)):((0,r.openBlock)(),(0,r.createElementBlock)("span",H,(0,r.toDisplayString)(e.title),1))])])])))),128))])}]]);var X=a(9269),Y=a.n(X);const ee={components:{Pagination:v,SearchForm:U,Breadcrumbs:j,ListItems:Q},data:()=>({portalURL:"",baseURL:"",startURL:"",portalPath:"",fieldName:"",inputType:"",translations:{},data:{},breadcrumbs:[],selected:[],selectableTypes:[],traversableTypes:[],formData:{searchTerm:"",sortOn:"getObjPositionInParent",sortOrder:"ascending"}}),created(){this.baseURL=document.body.getAttribute("data-base-url"),this.portalURL=document.body.getAttribute("data-portal-url")},mounted(){const e=this.$refs.root.parentElement;this.startURL=e.getAttribute("data-starturl"),this.portalPath=e.getAttribute("data-portalpath"),this.fieldName=e.getAttribute("data-fieldname"),this.inputType=e.getAttribute("data-inputtype"),this.selectableTypes=JSON.parse(e.getAttribute("data-selectabletypes")),this.traversableTypes=JSON.parse(e.getAttribute("data-traversabletypes")),this.translations=JSON.parse(e.getAttribute("data-translations")),this.loadSelectedItems(e),this.$refs.modal.addEventListener("show.bs.modal",(()=>{this.fetchData(this.startURL)}))},methods:{async fetchData(e,t){let a={metadata_fields:["UID","is_folderish","portal_type"],sort_on:this.formData.sortOn,sort_order:this.formData.sortOrder};e||(e=this.data["@id"]);const r=-1!=e.indexOf("/@search");t&&(a=Object.assign(a,t)),r||(a.expand="breadcrumbs");const s=await this.axios.get(e,{params:a});this.data.items=s.data.items,this.data.items_total=s.data.items_total,this.data.batching=s.data.batching,r||(this.data["@id"]=s.data["@id"]),s.data["@components"]&&(this.breadcrumbs=s.data["@components"].breadcrumbs.items)},search(e){this.formData=Object.assign({},this.formData,e);const t=this.data["@id"]+"/@search";let a={"path.query":new URL(this.data["@id"]).pathname,"path.depth":1};this.formData.searchTerm.length>2&&(a.SearchableText="*"+this.formData.searchTerm+"*",a["path.depth"]=-1),this.fetchData(t,a)},reset(e){this.formData=e,this.fetchData(this.startURL)},updateSelected(e){this.selected=e,"radio"==this.inputType&&Y().fn.modal.Constructor.getInstance(this.$refs.modal).hide()},loadSelectedItems(e){e.parentElement.querySelectorAll(".selected_items input").forEach((e=>{this.selected.push(this.portalURL+e.value.replace(this.portalPath,""))})),e.parentElement.querySelector(".selected_items").remove()}},computed:{modalName(){return`reference-widget-modal-${this.fieldName.replace(/\./g,"_")}`}}},te=(0,y.Z)(ee,[["render",function(e,t,a,b,f,g){const y=(0,r.resolveComponent)("searchForm"),v=(0,r.resolveComponent)("Breadcrumbs"),k=(0,r.resolveComponent)("Pagination"),E=(0,r.resolveComponent)("ListItems");return(0,r.openBlock)(),(0,r.createElementBlock)("div",s,[(0,r.createElementVNode)("div",l,[(0,r.createElementVNode)("ul",o,[((0,r.openBlock)(!0),(0,r.createElementBlock)(r.Fragment,null,(0,r.renderList)(f.selected,(e=>((0,r.openBlock)(),(0,r.createElementBlock)("li",{class:"list-group-item",key:e},[(0,r.createElementVNode)("input",{type:"checkbox",checked:"",name:f.fieldName,value:e.replace(f.portalURL,f.portalPath)},null,8,i),(0,r.createTextVNode)(" "+(0,r.toDisplayString)(e),1)])))),128))])]),(0,r.createElementVNode)("button",{type:"button",class:"btn btn-primary","data-bs-toggle":"modal","data-bs-target":`#${g.modalName}`}," Browse ",8,c),(0,r.createElementVNode)("div",{id:g.modalName,class:"modal fade",tabindex:"-1","aria-labelledby":"ref-modal-title","aria-hidden":"true",ref:"modal"},[(0,r.createElementVNode)("div",d,[(0,r.createElementVNode)("div",m,[p,(0,r.createElementVNode)("div",h,[(0,r.createVNode)(y,{onSearch:g.search,onReset:g.reset},null,8,["onSearch","onReset"]),(0,r.createVNode)(v,{breadcrumbs:f.breadcrumbs,fetchData:g.fetchData,portalURL:f.portalURL},null,8,["breadcrumbs","fetchData","portalURL"]),f.data.batching?((0,r.openBlock)(),(0,r.createBlock)(k,{key:0,onNext:g.fetchData,onPrevious:g.fetchData,batching:f.data.batching},null,8,["onNext","onPrevious","batching"])):(0,r.createCommentVNode)("v-if",!0),(0,r.createTextVNode)(" total "+(0,r.toDisplayString)(f.data.items_total)+" ",1),(0,r.createVNode)(E,{fetchData:g.fetchData,items:f.data.items,selectedItems:f.selected,inputType:f.inputType,selectableTypes:f.selectableTypes,traversableTypes:f.traversableTypes,onChecked:g.updateSelected},null,8,["fetchData","items","selectedItems","inputType","selectableTypes","traversableTypes","onChecked"])]),u])])],8,n)],512)}]]);var ae=a(4382),re=a.n(ae),se=a(9931),le=a.n(se),oe=a(8731),ie=a.n(oe);function ce(){document.querySelectorAll(".reference-widget-app").forEach((e=>{if(e.classList.contains("initialized"))return;const t=(0,r.createApp)(te);t.use(re(),{axios:le().create({paramsSerializer:e=>ie().stringify(e,{arrayFormat:"repeat"}),headers:{Accept:"application/json","Content-Type":"application/json",Prefer:"return=representation"}})}),t.mount(e),e.classList.add("initialized")}))}ce(),window.initReferenceWidget=ce},3744:(e,t)=>{t.Z=(e,t)=>{const a=e.__vccOpts||e;for(const[e,r]of t)a[e]=r;return a}}}]);
//# sourceMappingURL=92bd9d41ef49ea0e905a.min.js.map