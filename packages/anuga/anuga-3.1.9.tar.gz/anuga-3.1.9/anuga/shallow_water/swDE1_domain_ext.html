<!DOCTYPE html>
<!-- Generated by Cython 0.29.30 -->
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Cython: swDE1_domain_ext.pyx</title>
    <style type="text/css">
    
body.cython { font-family: courier; font-size: 12; }

.cython.tag  {  }
.cython.line { margin: 0em }
.cython.code { font-size: 9; color: #444444; display: none; margin: 0px 0px 0px 8px; border-left: 8px none; }

.cython.line .run { background-color: #B0FFB0; }
.cython.line .mis { background-color: #FFB0B0; }
.cython.code.run  { border-left: 8px solid #B0FFB0; }
.cython.code.mis  { border-left: 8px solid #FFB0B0; }

.cython.code .py_c_api  { color: red; }
.cython.code .py_macro_api  { color: #FF7000; }
.cython.code .pyx_c_api  { color: #FF3000; }
.cython.code .pyx_macro_api  { color: #FF7000; }
.cython.code .refnanny  { color: #FFA000; }
.cython.code .trace  { color: #FFA000; }
.cython.code .error_goto  { color: #FFA000; }

.cython.code .coerce  { color: #008000; border: 1px dotted #008000 }
.cython.code .py_attr { color: #FF0000; font-weight: bold; }
.cython.code .c_attr  { color: #0000FF; }
.cython.code .py_call { color: #FF0000; font-weight: bold; }
.cython.code .c_call  { color: #0000FF; }

.cython.score-0 {background-color: #FFFFff;}
.cython.score-1 {background-color: #FFFFe7;}
.cython.score-2 {background-color: #FFFFd4;}
.cython.score-3 {background-color: #FFFFc4;}
.cython.score-4 {background-color: #FFFFb6;}
.cython.score-5 {background-color: #FFFFaa;}
.cython.score-6 {background-color: #FFFF9f;}
.cython.score-7 {background-color: #FFFF96;}
.cython.score-8 {background-color: #FFFF8d;}
.cython.score-9 {background-color: #FFFF86;}
.cython.score-10 {background-color: #FFFF7f;}
.cython.score-11 {background-color: #FFFF79;}
.cython.score-12 {background-color: #FFFF73;}
.cython.score-13 {background-color: #FFFF6e;}
.cython.score-14 {background-color: #FFFF6a;}
.cython.score-15 {background-color: #FFFF66;}
.cython.score-16 {background-color: #FFFF62;}
.cython.score-17 {background-color: #FFFF5e;}
.cython.score-18 {background-color: #FFFF5b;}
.cython.score-19 {background-color: #FFFF57;}
.cython.score-20 {background-color: #FFFF55;}
.cython.score-21 {background-color: #FFFF52;}
.cython.score-22 {background-color: #FFFF4f;}
.cython.score-23 {background-color: #FFFF4d;}
.cython.score-24 {background-color: #FFFF4b;}
.cython.score-25 {background-color: #FFFF48;}
.cython.score-26 {background-color: #FFFF46;}
.cython.score-27 {background-color: #FFFF44;}
.cython.score-28 {background-color: #FFFF43;}
.cython.score-29 {background-color: #FFFF41;}
.cython.score-30 {background-color: #FFFF3f;}
.cython.score-31 {background-color: #FFFF3e;}
.cython.score-32 {background-color: #FFFF3c;}
.cython.score-33 {background-color: #FFFF3b;}
.cython.score-34 {background-color: #FFFF39;}
.cython.score-35 {background-color: #FFFF38;}
.cython.score-36 {background-color: #FFFF37;}
.cython.score-37 {background-color: #FFFF36;}
.cython.score-38 {background-color: #FFFF35;}
.cython.score-39 {background-color: #FFFF34;}
.cython.score-40 {background-color: #FFFF33;}
.cython.score-41 {background-color: #FFFF32;}
.cython.score-42 {background-color: #FFFF31;}
.cython.score-43 {background-color: #FFFF30;}
.cython.score-44 {background-color: #FFFF2f;}
.cython.score-45 {background-color: #FFFF2e;}
.cython.score-46 {background-color: #FFFF2d;}
.cython.score-47 {background-color: #FFFF2c;}
.cython.score-48 {background-color: #FFFF2b;}
.cython.score-49 {background-color: #FFFF2b;}
.cython.score-50 {background-color: #FFFF2a;}
.cython.score-51 {background-color: #FFFF29;}
.cython.score-52 {background-color: #FFFF29;}
.cython.score-53 {background-color: #FFFF28;}
.cython.score-54 {background-color: #FFFF27;}
.cython.score-55 {background-color: #FFFF27;}
.cython.score-56 {background-color: #FFFF26;}
.cython.score-57 {background-color: #FFFF26;}
.cython.score-58 {background-color: #FFFF25;}
.cython.score-59 {background-color: #FFFF24;}
.cython.score-60 {background-color: #FFFF24;}
.cython.score-61 {background-color: #FFFF23;}
.cython.score-62 {background-color: #FFFF23;}
.cython.score-63 {background-color: #FFFF22;}
.cython.score-64 {background-color: #FFFF22;}
.cython.score-65 {background-color: #FFFF22;}
.cython.score-66 {background-color: #FFFF21;}
.cython.score-67 {background-color: #FFFF21;}
.cython.score-68 {background-color: #FFFF20;}
.cython.score-69 {background-color: #FFFF20;}
.cython.score-70 {background-color: #FFFF1f;}
.cython.score-71 {background-color: #FFFF1f;}
.cython.score-72 {background-color: #FFFF1f;}
.cython.score-73 {background-color: #FFFF1e;}
.cython.score-74 {background-color: #FFFF1e;}
.cython.score-75 {background-color: #FFFF1e;}
.cython.score-76 {background-color: #FFFF1d;}
.cython.score-77 {background-color: #FFFF1d;}
.cython.score-78 {background-color: #FFFF1c;}
.cython.score-79 {background-color: #FFFF1c;}
.cython.score-80 {background-color: #FFFF1c;}
.cython.score-81 {background-color: #FFFF1c;}
.cython.score-82 {background-color: #FFFF1b;}
.cython.score-83 {background-color: #FFFF1b;}
.cython.score-84 {background-color: #FFFF1b;}
.cython.score-85 {background-color: #FFFF1a;}
.cython.score-86 {background-color: #FFFF1a;}
.cython.score-87 {background-color: #FFFF1a;}
.cython.score-88 {background-color: #FFFF1a;}
.cython.score-89 {background-color: #FFFF19;}
.cython.score-90 {background-color: #FFFF19;}
.cython.score-91 {background-color: #FFFF19;}
.cython.score-92 {background-color: #FFFF19;}
.cython.score-93 {background-color: #FFFF18;}
.cython.score-94 {background-color: #FFFF18;}
.cython.score-95 {background-color: #FFFF18;}
.cython.score-96 {background-color: #FFFF18;}
.cython.score-97 {background-color: #FFFF17;}
.cython.score-98 {background-color: #FFFF17;}
.cython.score-99 {background-color: #FFFF17;}
.cython.score-100 {background-color: #FFFF17;}
.cython.score-101 {background-color: #FFFF16;}
.cython.score-102 {background-color: #FFFF16;}
.cython.score-103 {background-color: #FFFF16;}
.cython.score-104 {background-color: #FFFF16;}
.cython.score-105 {background-color: #FFFF16;}
.cython.score-106 {background-color: #FFFF15;}
.cython.score-107 {background-color: #FFFF15;}
.cython.score-108 {background-color: #FFFF15;}
.cython.score-109 {background-color: #FFFF15;}
.cython.score-110 {background-color: #FFFF15;}
.cython.score-111 {background-color: #FFFF15;}
.cython.score-112 {background-color: #FFFF14;}
.cython.score-113 {background-color: #FFFF14;}
.cython.score-114 {background-color: #FFFF14;}
.cython.score-115 {background-color: #FFFF14;}
.cython.score-116 {background-color: #FFFF14;}
.cython.score-117 {background-color: #FFFF14;}
.cython.score-118 {background-color: #FFFF13;}
.cython.score-119 {background-color: #FFFF13;}
.cython.score-120 {background-color: #FFFF13;}
.cython.score-121 {background-color: #FFFF13;}
.cython.score-122 {background-color: #FFFF13;}
.cython.score-123 {background-color: #FFFF13;}
.cython.score-124 {background-color: #FFFF13;}
.cython.score-125 {background-color: #FFFF12;}
.cython.score-126 {background-color: #FFFF12;}
.cython.score-127 {background-color: #FFFF12;}
.cython.score-128 {background-color: #FFFF12;}
.cython.score-129 {background-color: #FFFF12;}
.cython.score-130 {background-color: #FFFF12;}
.cython.score-131 {background-color: #FFFF12;}
.cython.score-132 {background-color: #FFFF11;}
.cython.score-133 {background-color: #FFFF11;}
.cython.score-134 {background-color: #FFFF11;}
.cython.score-135 {background-color: #FFFF11;}
.cython.score-136 {background-color: #FFFF11;}
.cython.score-137 {background-color: #FFFF11;}
.cython.score-138 {background-color: #FFFF11;}
.cython.score-139 {background-color: #FFFF11;}
.cython.score-140 {background-color: #FFFF11;}
.cython.score-141 {background-color: #FFFF10;}
.cython.score-142 {background-color: #FFFF10;}
.cython.score-143 {background-color: #FFFF10;}
.cython.score-144 {background-color: #FFFF10;}
.cython.score-145 {background-color: #FFFF10;}
.cython.score-146 {background-color: #FFFF10;}
.cython.score-147 {background-color: #FFFF10;}
.cython.score-148 {background-color: #FFFF10;}
.cython.score-149 {background-color: #FFFF10;}
.cython.score-150 {background-color: #FFFF0f;}
.cython.score-151 {background-color: #FFFF0f;}
.cython.score-152 {background-color: #FFFF0f;}
.cython.score-153 {background-color: #FFFF0f;}
.cython.score-154 {background-color: #FFFF0f;}
.cython.score-155 {background-color: #FFFF0f;}
.cython.score-156 {background-color: #FFFF0f;}
.cython.score-157 {background-color: #FFFF0f;}
.cython.score-158 {background-color: #FFFF0f;}
.cython.score-159 {background-color: #FFFF0f;}
.cython.score-160 {background-color: #FFFF0f;}
.cython.score-161 {background-color: #FFFF0e;}
.cython.score-162 {background-color: #FFFF0e;}
.cython.score-163 {background-color: #FFFF0e;}
.cython.score-164 {background-color: #FFFF0e;}
.cython.score-165 {background-color: #FFFF0e;}
.cython.score-166 {background-color: #FFFF0e;}
.cython.score-167 {background-color: #FFFF0e;}
.cython.score-168 {background-color: #FFFF0e;}
.cython.score-169 {background-color: #FFFF0e;}
.cython.score-170 {background-color: #FFFF0e;}
.cython.score-171 {background-color: #FFFF0e;}
.cython.score-172 {background-color: #FFFF0e;}
.cython.score-173 {background-color: #FFFF0d;}
.cython.score-174 {background-color: #FFFF0d;}
.cython.score-175 {background-color: #FFFF0d;}
.cython.score-176 {background-color: #FFFF0d;}
.cython.score-177 {background-color: #FFFF0d;}
.cython.score-178 {background-color: #FFFF0d;}
.cython.score-179 {background-color: #FFFF0d;}
.cython.score-180 {background-color: #FFFF0d;}
.cython.score-181 {background-color: #FFFF0d;}
.cython.score-182 {background-color: #FFFF0d;}
.cython.score-183 {background-color: #FFFF0d;}
.cython.score-184 {background-color: #FFFF0d;}
.cython.score-185 {background-color: #FFFF0d;}
.cython.score-186 {background-color: #FFFF0d;}
.cython.score-187 {background-color: #FFFF0c;}
.cython.score-188 {background-color: #FFFF0c;}
.cython.score-189 {background-color: #FFFF0c;}
.cython.score-190 {background-color: #FFFF0c;}
.cython.score-191 {background-color: #FFFF0c;}
.cython.score-192 {background-color: #FFFF0c;}
.cython.score-193 {background-color: #FFFF0c;}
.cython.score-194 {background-color: #FFFF0c;}
.cython.score-195 {background-color: #FFFF0c;}
.cython.score-196 {background-color: #FFFF0c;}
.cython.score-197 {background-color: #FFFF0c;}
.cython.score-198 {background-color: #FFFF0c;}
.cython.score-199 {background-color: #FFFF0c;}
.cython.score-200 {background-color: #FFFF0c;}
.cython.score-201 {background-color: #FFFF0c;}
.cython.score-202 {background-color: #FFFF0c;}
.cython.score-203 {background-color: #FFFF0b;}
.cython.score-204 {background-color: #FFFF0b;}
.cython.score-205 {background-color: #FFFF0b;}
.cython.score-206 {background-color: #FFFF0b;}
.cython.score-207 {background-color: #FFFF0b;}
.cython.score-208 {background-color: #FFFF0b;}
.cython.score-209 {background-color: #FFFF0b;}
.cython.score-210 {background-color: #FFFF0b;}
.cython.score-211 {background-color: #FFFF0b;}
.cython.score-212 {background-color: #FFFF0b;}
.cython.score-213 {background-color: #FFFF0b;}
.cython.score-214 {background-color: #FFFF0b;}
.cython.score-215 {background-color: #FFFF0b;}
.cython.score-216 {background-color: #FFFF0b;}
.cython.score-217 {background-color: #FFFF0b;}
.cython.score-218 {background-color: #FFFF0b;}
.cython.score-219 {background-color: #FFFF0b;}
.cython.score-220 {background-color: #FFFF0b;}
.cython.score-221 {background-color: #FFFF0b;}
.cython.score-222 {background-color: #FFFF0a;}
.cython.score-223 {background-color: #FFFF0a;}
.cython.score-224 {background-color: #FFFF0a;}
.cython.score-225 {background-color: #FFFF0a;}
.cython.score-226 {background-color: #FFFF0a;}
.cython.score-227 {background-color: #FFFF0a;}
.cython.score-228 {background-color: #FFFF0a;}
.cython.score-229 {background-color: #FFFF0a;}
.cython.score-230 {background-color: #FFFF0a;}
.cython.score-231 {background-color: #FFFF0a;}
.cython.score-232 {background-color: #FFFF0a;}
.cython.score-233 {background-color: #FFFF0a;}
.cython.score-234 {background-color: #FFFF0a;}
.cython.score-235 {background-color: #FFFF0a;}
.cython.score-236 {background-color: #FFFF0a;}
.cython.score-237 {background-color: #FFFF0a;}
.cython.score-238 {background-color: #FFFF0a;}
.cython.score-239 {background-color: #FFFF0a;}
.cython.score-240 {background-color: #FFFF0a;}
.cython.score-241 {background-color: #FFFF0a;}
.cython.score-242 {background-color: #FFFF0a;}
.cython.score-243 {background-color: #FFFF0a;}
.cython.score-244 {background-color: #FFFF0a;}
.cython.score-245 {background-color: #FFFF0a;}
.cython.score-246 {background-color: #FFFF09;}
.cython.score-247 {background-color: #FFFF09;}
.cython.score-248 {background-color: #FFFF09;}
.cython.score-249 {background-color: #FFFF09;}
.cython.score-250 {background-color: #FFFF09;}
.cython.score-251 {background-color: #FFFF09;}
.cython.score-252 {background-color: #FFFF09;}
.cython.score-253 {background-color: #FFFF09;}
.cython.score-254 {background-color: #FFFF09;}
    </style>
</head>
<body class="cython">
<p><span style="border-bottom: solid 1px grey;">Generated by Cython 0.29.30</span></p>
<p>
    <span style="background-color: #FFFF00">Yellow lines</span> hint at Python interaction.<br />
    Click on a line that starts with a "<code>+</code>" to see the C code that Cython generated for it.
</p>
<p>Raw output: <a href="swDE1_domain_ext.c">swDE1_domain_ext.c</a></p>
<div class="cython"><pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">001</span>: #cython: wraparound=False, boundscheck=False, cdivision=True, profile=False, nonecheck=False, overflowcheck=False, cdivision_warnings=False, unraisable_tracebacks=False</pre>
<pre class='cython code score-8 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_test, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 1, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">002</span>: import cython</pre>
<pre class="cython line score-0">&#xA0;<span class="">003</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">004</span>: # import both numpy and the Cython declarations for numpy</pre>
<pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">005</span>: import numpy as np</pre>
<pre class='cython code score-8 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_Import</span>(__pyx_n_s_numpy, 0, -1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 5, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_np, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 5, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">006</span>: cimport numpy as np</pre>
<pre class="cython line score-0">&#xA0;<span class="">007</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">008</span>: cdef extern from "swDE1_domain.c" nogil:</pre>
<pre class="cython line score-0">&#xA0;<span class="">009</span>: 	struct domain:</pre>
<pre class="cython line score-0">&#xA0;<span class="">010</span>: 		long number_of_elements</pre>
<pre class="cython line score-0">&#xA0;<span class="">011</span>: 		double epsilon</pre>
<pre class="cython line score-0">&#xA0;<span class="">012</span>: 		double H0</pre>
<pre class="cython line score-0">&#xA0;<span class="">013</span>: 		double g</pre>
<pre class="cython line score-0">&#xA0;<span class="">014</span>: 		long optimise_dry_cells</pre>
<pre class="cython line score-0">&#xA0;<span class="">015</span>: 		double evolve_max_timestep</pre>
<pre class="cython line score-0">&#xA0;<span class="">016</span>: 		long extrapolate_velocity_second_order</pre>
<pre class="cython line score-0">&#xA0;<span class="">017</span>: 		double minimum_allowed_height</pre>
<pre class="cython line score-0">&#xA0;<span class="">018</span>: 		double maximum_allowed_speed</pre>
<pre class="cython line score-0">&#xA0;<span class="">019</span>: 		long low_froude</pre>
<pre class="cython line score-0">&#xA0;<span class="">020</span>: 		long timestep_fluxcalls</pre>
<pre class="cython line score-0">&#xA0;<span class="">021</span>: 		double beta_w</pre>
<pre class="cython line score-0">&#xA0;<span class="">022</span>: 		double beta_w_dry</pre>
<pre class="cython line score-0">&#xA0;<span class="">023</span>: 		double beta_uh</pre>
<pre class="cython line score-0">&#xA0;<span class="">024</span>: 		double beta_uh_dry</pre>
<pre class="cython line score-0">&#xA0;<span class="">025</span>: 		double beta_vh</pre>
<pre class="cython line score-0">&#xA0;<span class="">026</span>: 		double beta_vh_dry</pre>
<pre class="cython line score-0">&#xA0;<span class="">027</span>: 		long max_flux_update_frequency</pre>
<pre class="cython line score-0">&#xA0;<span class="">028</span>: 		long ncol_riverwall_hydraulic_properties</pre>
<pre class="cython line score-0">&#xA0;<span class="">029</span>: 		long* neighbours</pre>
<pre class="cython line score-0">&#xA0;<span class="">030</span>: 		long* neighbour_edges</pre>
<pre class="cython line score-0">&#xA0;<span class="">031</span>: 		long* surrogate_neighbours</pre>
<pre class="cython line score-0">&#xA0;<span class="">032</span>: 		double* normals</pre>
<pre class="cython line score-0">&#xA0;<span class="">033</span>: 		double* edgelengths</pre>
<pre class="cython line score-0">&#xA0;<span class="">034</span>: 		double* radii</pre>
<pre class="cython line score-0">&#xA0;<span class="">035</span>: 		double* areas</pre>
<pre class="cython line score-0">&#xA0;<span class="">036</span>: 		long* edge_flux_type</pre>
<pre class="cython line score-0">&#xA0;<span class="">037</span>: 		long* tri_full_flag</pre>
<pre class="cython line score-0">&#xA0;<span class="">038</span>: 		long* already_computed_flux</pre>
<pre class="cython line score-0">&#xA0;<span class="">039</span>: 		double* max_speed</pre>
<pre class="cython line score-0">&#xA0;<span class="">040</span>: 		double* vertex_coordinates</pre>
<pre class="cython line score-0">&#xA0;<span class="">041</span>: 		double* edge_coordinates</pre>
<pre class="cython line score-0">&#xA0;<span class="">042</span>: 		double* centroid_coordinates</pre>
<pre class="cython line score-0">&#xA0;<span class="">043</span>: 		long* number_of_boundaries</pre>
<pre class="cython line score-0">&#xA0;<span class="">044</span>: 		double* stage_edge_values</pre>
<pre class="cython line score-0">&#xA0;<span class="">045</span>: 		double* xmom_edge_values</pre>
<pre class="cython line score-0">&#xA0;<span class="">046</span>: 		double* ymom_edge_values</pre>
<pre class="cython line score-0">&#xA0;<span class="">047</span>: 		double* bed_edge_values</pre>
<pre class="cython line score-0">&#xA0;<span class="">048</span>: 		double* height_edge_values</pre>
<pre class="cython line score-0">&#xA0;<span class="">049</span>: 		double* stage_centroid_values</pre>
<pre class="cython line score-0">&#xA0;<span class="">050</span>: 		double* xmom_centroid_values</pre>
<pre class="cython line score-0">&#xA0;<span class="">051</span>: 		double* ymom_centroid_values</pre>
<pre class="cython line score-0">&#xA0;<span class="">052</span>: 		double* bed_centroid_values</pre>
<pre class="cython line score-0">&#xA0;<span class="">053</span>: 		double* height_centroid_values</pre>
<pre class="cython line score-0">&#xA0;<span class="">054</span>: 		double* stage_vertex_values</pre>
<pre class="cython line score-0">&#xA0;<span class="">055</span>: 		double* xmom_vertex_values</pre>
<pre class="cython line score-0">&#xA0;<span class="">056</span>: 		double* ymom_vertex_values</pre>
<pre class="cython line score-0">&#xA0;<span class="">057</span>: 		double* bed_vertex_values</pre>
<pre class="cython line score-0">&#xA0;<span class="">058</span>: 		double* height_vertex_values</pre>
<pre class="cython line score-0">&#xA0;<span class="">059</span>: 		double* stage_boundary_values</pre>
<pre class="cython line score-0">&#xA0;<span class="">060</span>: 		double* xmom_boundary_values</pre>
<pre class="cython line score-0">&#xA0;<span class="">061</span>: 		double* ymom_boundary_values</pre>
<pre class="cython line score-0">&#xA0;<span class="">062</span>: 		double* bed_boundary_values</pre>
<pre class="cython line score-0">&#xA0;<span class="">063</span>: 		double* stage_explicit_update</pre>
<pre class="cython line score-0">&#xA0;<span class="">064</span>: 		double* xmom_explicit_update</pre>
<pre class="cython line score-0">&#xA0;<span class="">065</span>: 		double* ymom_explicit_update</pre>
<pre class="cython line score-0">&#xA0;<span class="">066</span>: 		long* flux_update_frequency</pre>
<pre class="cython line score-0">&#xA0;<span class="">067</span>: 		long* update_next_flux</pre>
<pre class="cython line score-0">&#xA0;<span class="">068</span>: 		long* update_extrapolation</pre>
<pre class="cython line score-0">&#xA0;<span class="">069</span>: 		double* edge_timestep</pre>
<pre class="cython line score-0">&#xA0;<span class="">070</span>: 		double* edge_flux_work</pre>
<pre class="cython line score-0">&#xA0;<span class="">071</span>: 		double* pressuregrad_work</pre>
<pre class="cython line score-0">&#xA0;<span class="">072</span>: 		double* x_centroid_work</pre>
<pre class="cython line score-0">&#xA0;<span class="">073</span>: 		double* y_centroid_work</pre>
<pre class="cython line score-0">&#xA0;<span class="">074</span>: 		double* boundary_flux_sum</pre>
<pre class="cython line score-0">&#xA0;<span class="">075</span>: 		long* allow_timestep_increase</pre>
<pre class="cython line score-0">&#xA0;<span class="">076</span>: 		double* riverwall_elevation</pre>
<pre class="cython line score-0">&#xA0;<span class="">077</span>: 		long* riverwall_rowIndex</pre>
<pre class="cython line score-0">&#xA0;<span class="">078</span>: 		double* riverwall_hydraulic_properties</pre>
<pre class="cython line score-0">&#xA0;<span class="">079</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">080</span>: 	struct edge:</pre>
<pre class="cython line score-0">&#xA0;<span class="">081</span>: 		pass</pre>
<pre class="cython line score-0">&#xA0;<span class="">082</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">083</span>: 	int _compute_flux_update_frequency(domain* D, double timestep)</pre>
<pre class="cython line score-0">&#xA0;<span class="">084</span>: 	double _compute_fluxes_central(domain* D, double timestep)</pre>
<pre class="cython line score-0">&#xA0;<span class="">085</span>: 	double _protect_new(domain* D)</pre>
<pre class="cython line score-0">&#xA0;<span class="">086</span>: 	int _extrapolate_second_order_edge_sw(domain* D)</pre>
<pre class="cython line score-0">&#xA0;<span class="">087</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">088</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">089</span>: cdef int pointer_flag = 0</pre>
<pre class='cython code score-0 '>  __pyx_v_5anuga_13shallow_water_16swDE1_domain_ext_pointer_flag = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">090</span>: cdef int parameter_flag = 0</pre>
<pre class='cython code score-0 '>  __pyx_v_5anuga_13shallow_water_16swDE1_domain_ext_parameter_flag = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">091</span>: </pre>
<pre class="cython line score-4" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">092</span>: cdef inline get_python_domain_parameters(domain *D, object domain_object):</pre>
<pre class='cython code score-4 '>static CYTHON_INLINE PyObject *__pyx_f_5anuga_13shallow_water_16swDE1_domain_ext_get_python_domain_parameters(struct domain *__pyx_v_D, PyObject *__pyx_v_domain_object) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("get_python_domain_parameters", 0);
/* … */
  /* function exit code */
  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("anuga.shallow_water.swDE1_domain_ext.get_python_domain_parameters", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">093</span>: </pre>
<pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">094</span>: 	D.number_of_elements = domain_object.number_of_elements</pre>
<pre class='cython code score-10 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_domain_object, __pyx_n_s_number_of_elements);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 94, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyInt_As_long</span>(__pyx_t_1); if (unlikely((__pyx_t_2 == (long)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 94, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_D-&gt;number_of_elements = __pyx_t_2;
</pre><pre class="cython line score-13" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">095</span>: 	D.epsilon = domain_object.epsilon</pre>
<pre class='cython code score-13 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_domain_object, __pyx_n_s_epsilon);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 95, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_3 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_1); if (unlikely((__pyx_t_3 == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 95, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_D-&gt;epsilon = __pyx_t_3;
</pre><pre class="cython line score-13" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">096</span>: 	D.H0 = domain_object.H0</pre>
<pre class='cython code score-13 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_domain_object, __pyx_n_s_H0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 96, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_3 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_1); if (unlikely((__pyx_t_3 == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 96, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_D-&gt;H0 = __pyx_t_3;
</pre><pre class="cython line score-13" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">097</span>: 	D.g = domain_object.g</pre>
<pre class='cython code score-13 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_domain_object, __pyx_n_s_g);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 97, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_3 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_1); if (unlikely((__pyx_t_3 == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 97, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_D-&gt;g = __pyx_t_3;
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">098</span>: 	D.optimise_dry_cells = domain_object.optimise_dry_cells</pre>
<pre class='cython code score-10 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_domain_object, __pyx_n_s_optimise_dry_cells);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 98, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyInt_As_long</span>(__pyx_t_1); if (unlikely((__pyx_t_2 == (long)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 98, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_D-&gt;optimise_dry_cells = __pyx_t_2;
</pre><pre class="cython line score-13" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">099</span>: 	D.evolve_max_timestep = domain_object.evolve_max_timestep</pre>
<pre class='cython code score-13 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_domain_object, __pyx_n_s_evolve_max_timestep);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 99, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_3 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_1); if (unlikely((__pyx_t_3 == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 99, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_D-&gt;evolve_max_timestep = __pyx_t_3;
</pre><pre class="cython line score-13" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">100</span>: 	D.minimum_allowed_height = domain_object.minimum_allowed_height</pre>
<pre class='cython code score-13 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_domain_object, __pyx_n_s_minimum_allowed_height);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 100, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_3 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_1); if (unlikely((__pyx_t_3 == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 100, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_D-&gt;minimum_allowed_height = __pyx_t_3;
</pre><pre class="cython line score-13" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">101</span>: 	D.maximum_allowed_speed = domain_object.maximum_allowed_speed</pre>
<pre class='cython code score-13 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_domain_object, __pyx_n_s_maximum_allowed_speed);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 101, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_3 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_1); if (unlikely((__pyx_t_3 == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 101, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_D-&gt;maximum_allowed_speed = __pyx_t_3;
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">102</span>: 	D.timestep_fluxcalls = domain_object.timestep_fluxcalls</pre>
<pre class='cython code score-10 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_domain_object, __pyx_n_s_timestep_fluxcalls);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 102, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyInt_As_long</span>(__pyx_t_1); if (unlikely((__pyx_t_2 == (long)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 102, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_D-&gt;timestep_fluxcalls = __pyx_t_2;
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">103</span>: 	D.low_froude = domain_object.low_froude</pre>
<pre class='cython code score-10 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_domain_object, __pyx_n_s_low_froude);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 103, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyInt_As_long</span>(__pyx_t_1); if (unlikely((__pyx_t_2 == (long)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 103, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_D-&gt;low_froude = __pyx_t_2;
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">104</span>: 	D.extrapolate_velocity_second_order = domain_object.extrapolate_velocity_second_order</pre>
<pre class='cython code score-10 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_domain_object, __pyx_n_s_extrapolate_velocity_second_orde);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 104, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyInt_As_long</span>(__pyx_t_1); if (unlikely((__pyx_t_2 == (long)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 104, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_D-&gt;extrapolate_velocity_second_order = __pyx_t_2;
</pre><pre class="cython line score-13" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">105</span>: 	D.beta_w = domain_object.beta_w</pre>
<pre class='cython code score-13 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_domain_object, __pyx_n_s_beta_w);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 105, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_3 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_1); if (unlikely((__pyx_t_3 == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 105, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_D-&gt;beta_w = __pyx_t_3;
</pre><pre class="cython line score-13" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">106</span>: 	D.beta_w_dry = domain_object.beta_w_dry</pre>
<pre class='cython code score-13 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_domain_object, __pyx_n_s_beta_w_dry);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 106, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_3 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_1); if (unlikely((__pyx_t_3 == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 106, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_D-&gt;beta_w_dry = __pyx_t_3;
</pre><pre class="cython line score-13" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">107</span>: 	D.beta_uh = domain_object.beta_uh</pre>
<pre class='cython code score-13 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_domain_object, __pyx_n_s_beta_uh);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 107, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_3 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_1); if (unlikely((__pyx_t_3 == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 107, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_D-&gt;beta_uh = __pyx_t_3;
</pre><pre class="cython line score-13" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">108</span>: 	D.beta_uh_dry = domain_object.beta_uh_dry</pre>
<pre class='cython code score-13 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_domain_object, __pyx_n_s_beta_uh_dry);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 108, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_3 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_1); if (unlikely((__pyx_t_3 == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 108, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_D-&gt;beta_uh_dry = __pyx_t_3;
</pre><pre class="cython line score-13" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">109</span>: 	D.beta_vh = domain_object.beta_vh</pre>
<pre class='cython code score-13 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_domain_object, __pyx_n_s_beta_vh);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 109, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_3 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_1); if (unlikely((__pyx_t_3 == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 109, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_D-&gt;beta_vh = __pyx_t_3;
</pre><pre class="cython line score-13" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">110</span>: 	D.beta_vh_dry = domain_object.beta_vh_dry</pre>
<pre class='cython code score-13 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_domain_object, __pyx_n_s_beta_vh_dry);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 110, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_3 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_1); if (unlikely((__pyx_t_3 == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 110, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_D-&gt;beta_vh_dry = __pyx_t_3;
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">111</span>: 	D.max_flux_update_frequency = domain_object.max_flux_update_frequency</pre>
<pre class='cython code score-10 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_domain_object, __pyx_n_s_max_flux_update_frequency);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 111, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyInt_As_long</span>(__pyx_t_1); if (unlikely((__pyx_t_2 == (long)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 111, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_D-&gt;max_flux_update_frequency = __pyx_t_2;
</pre><pre class="cython line score-0">&#xA0;<span class="">112</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">113</span>: </pre>
<pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">114</span>: cdef inline get_python_domain_pointers(domain *D, object domain_object):</pre>
<pre class='cython code score-11 '>static CYTHON_INLINE PyObject *__pyx_f_5anuga_13shallow_water_16swDE1_domain_ext_get_python_domain_pointers(struct domain *__pyx_v_D, PyObject *__pyx_v_domain_object) {
  __Pyx_memviewslice __pyx_v_neighbours = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_neighbour_edges = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_normals = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_edgelengths = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_radii = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_areas = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_edge_flux_type = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_tri_full_flag = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_already_computed_flux = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_vertex_coordinates = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_edge_coordinates = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_centroid_coordinates = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_number_of_boundaries = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_surrogate_neighbours = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_max_speed = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_flux_update_frequency = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_update_next_flux = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_update_extrapolation = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_allow_timestep_increase = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_edge_timestep = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_edge_flux_work = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_pressuregrad_work = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_x_centroid_work = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_y_centroid_work = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_boundary_flux_sum = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_riverwall_elevation = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_riverwall_rowIndex = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_riverwall_hydraulic_properties = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_edge_values = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_centroid_values = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_vertex_values = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_boundary_values = { 0, 0, { 0 }, { 0 }, { 0 } };
  __Pyx_memviewslice __pyx_v_explicit_update = { 0, 0, { 0 }, { 0 }, { 0 } };
  PyObject *__pyx_v_quantities = 0;
  PyObject *__pyx_v_riverwallData = 0;
  PyObject *__pyx_v_stage = NULL;
  PyObject *__pyx_v_xmomentum = NULL;
  PyObject *__pyx_v_ymomentum = NULL;
  PyObject *__pyx_v_elevation = NULL;
  PyObject *__pyx_v_height = NULL;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("get_python_domain_pointers", 0);
/* … */
  /* function exit code */
  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_2, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_5, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_6, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_t_7, 1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("anuga.shallow_water.swDE1_domain_ext.get_python_domain_pointers", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_neighbours, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_neighbour_edges, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_normals, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_edgelengths, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_radii, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_areas, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_edge_flux_type, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_tri_full_flag, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_already_computed_flux, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_vertex_coordinates, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_edge_coordinates, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_centroid_coordinates, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_number_of_boundaries, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_surrogate_neighbours, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_max_speed, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_flux_update_frequency, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_update_next_flux, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_update_extrapolation, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_allow_timestep_increase, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_edge_timestep, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_edge_flux_work, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_pressuregrad_work, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_x_centroid_work, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_y_centroid_work, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_boundary_flux_sum, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_riverwall_elevation, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_riverwall_rowIndex, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_riverwall_hydraulic_properties, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_edge_values, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_centroid_values, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_vertex_values, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_boundary_values, 1);
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_explicit_update, 1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_quantities);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_riverwallData);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_stage);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_xmomentum);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_ymomentum);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_elevation);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_height);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">115</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">116</span>: 	cdef long[:,::1]   neighbours</pre>
<pre class="cython line score-0">&#xA0;<span class="">117</span>: 	cdef long[:,::1]   neighbour_edges</pre>
<pre class="cython line score-0">&#xA0;<span class="">118</span>: 	cdef double[:,::1] normals</pre>
<pre class="cython line score-0">&#xA0;<span class="">119</span>: 	cdef double[:,::1] edgelengths</pre>
<pre class="cython line score-0">&#xA0;<span class="">120</span>: 	cdef double[::1]   radii</pre>
<pre class="cython line score-0">&#xA0;<span class="">121</span>: 	cdef double[::1]   areas</pre>
<pre class="cython line score-0">&#xA0;<span class="">122</span>: 	cdef long[::1]     edge_flux_type</pre>
<pre class="cython line score-0">&#xA0;<span class="">123</span>: 	cdef long[::1]     tri_full_flag</pre>
<pre class="cython line score-0">&#xA0;<span class="">124</span>: 	cdef long[:,::1]   already_computed_flux</pre>
<pre class="cython line score-0">&#xA0;<span class="">125</span>: 	cdef double[:,::1] vertex_coordinates</pre>
<pre class="cython line score-0">&#xA0;<span class="">126</span>: 	cdef double[:,::1] edge_coordinates</pre>
<pre class="cython line score-0">&#xA0;<span class="">127</span>: 	cdef double[:,::1] centroid_coordinates</pre>
<pre class="cython line score-0">&#xA0;<span class="">128</span>: 	cdef long[::1]     number_of_boundaries</pre>
<pre class="cython line score-0">&#xA0;<span class="">129</span>: 	cdef long[:,::1]   surrogate_neighbours</pre>
<pre class="cython line score-0">&#xA0;<span class="">130</span>: 	cdef double[::1]   max_speed</pre>
<pre class="cython line score-0">&#xA0;<span class="">131</span>: 	cdef long[::1]     flux_update_frequency</pre>
<pre class="cython line score-0">&#xA0;<span class="">132</span>: 	cdef long[::1]     update_next_flux</pre>
<pre class="cython line score-0">&#xA0;<span class="">133</span>: 	cdef long[::1]     update_extrapolation</pre>
<pre class="cython line score-0">&#xA0;<span class="">134</span>: 	cdef long[::1]     allow_timestep_increase</pre>
<pre class="cython line score-0">&#xA0;<span class="">135</span>: 	cdef double[::1]   edge_timestep</pre>
<pre class="cython line score-0">&#xA0;<span class="">136</span>: 	cdef double[::1]   edge_flux_work</pre>
<pre class="cython line score-0">&#xA0;<span class="">137</span>: 	cdef double[::1]   pressuregrad_work</pre>
<pre class="cython line score-0">&#xA0;<span class="">138</span>: 	cdef double[::1]   x_centroid_work</pre>
<pre class="cython line score-0">&#xA0;<span class="">139</span>: 	cdef double[::1]   y_centroid_work</pre>
<pre class="cython line score-0">&#xA0;<span class="">140</span>: 	cdef double[::1]   boundary_flux_sum</pre>
<pre class="cython line score-0">&#xA0;<span class="">141</span>: 	cdef double[::1]   riverwall_elevation</pre>
<pre class="cython line score-0">&#xA0;<span class="">142</span>: 	cdef long[::1]     riverwall_rowIndex</pre>
<pre class="cython line score-0">&#xA0;<span class="">143</span>: 	cdef double[:,::1] riverwall_hydraulic_properties</pre>
<pre class="cython line score-0">&#xA0;<span class="">144</span>: 	cdef double[:,::1] edge_values</pre>
<pre class="cython line score-0">&#xA0;<span class="">145</span>: 	cdef double[::1]   centroid_values</pre>
<pre class="cython line score-0">&#xA0;<span class="">146</span>: 	cdef double[:,::1] vertex_values</pre>
<pre class="cython line score-0">&#xA0;<span class="">147</span>: 	cdef double[::1]   boundary_values</pre>
<pre class="cython line score-0">&#xA0;<span class="">148</span>: 	cdef double[::1]   explicit_update</pre>
<pre class="cython line score-0">&#xA0;<span class="">149</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">150</span>: 	cdef object quantities</pre>
<pre class="cython line score-0">&#xA0;<span class="">151</span>: 	cdef object riverwallData</pre>
<pre class="cython line score-0">&#xA0;<span class="">152</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">153</span>: 	#------------------------------------------------------</pre>
<pre class="cython line score-0">&#xA0;<span class="">154</span>: 	# Domain structures</pre>
<pre class="cython line score-0">&#xA0;<span class="">155</span>: 	#------------------------------------------------------</pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">156</span>: 	neighbours = domain_object.neighbours</pre>
<pre class='cython code score-5 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_domain_object, __pyx_n_s_neighbours);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 156, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_d_dc_long</span>(__pyx_t_1, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 156, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_neighbours = __pyx_t_2;
  __pyx_t_2.memview = NULL;
  __pyx_t_2.data = NULL;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">157</span>: 	D.neighbours = &amp;neighbours[0,0]</pre>
<pre class='cython code score-0 '>  __pyx_t_3 = 0;
  __pyx_t_4 = 0;
  __pyx_v_D-&gt;neighbours = (&amp;(*((long *) ( /* dim=1 */ ((char *) (((long *) ( /* dim=0 */ (__pyx_v_neighbours.data + __pyx_t_3 * __pyx_v_neighbours.strides[0]) )) + __pyx_t_4)) ))));
</pre><pre class="cython line score-0">&#xA0;<span class="">158</span>: </pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">159</span>: 	surrogate_neighbours = domain_object.surrogate_neighbours</pre>
<pre class='cython code score-5 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_domain_object, __pyx_n_s_surrogate_neighbours);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 159, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_d_dc_long</span>(__pyx_t_1, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 159, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_surrogate_neighbours = __pyx_t_2;
  __pyx_t_2.memview = NULL;
  __pyx_t_2.data = NULL;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">160</span>: 	D.surrogate_neighbours = &amp;surrogate_neighbours[0,0]</pre>
<pre class='cython code score-0 '>  __pyx_t_4 = 0;
  __pyx_t_3 = 0;
  __pyx_v_D-&gt;surrogate_neighbours = (&amp;(*((long *) ( /* dim=1 */ ((char *) (((long *) ( /* dim=0 */ (__pyx_v_surrogate_neighbours.data + __pyx_t_4 * __pyx_v_surrogate_neighbours.strides[0]) )) + __pyx_t_3)) ))));
</pre><pre class="cython line score-0">&#xA0;<span class="">161</span>: </pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">162</span>: 	neighbour_edges = domain_object.neighbour_edges</pre>
<pre class='cython code score-5 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_domain_object, __pyx_n_s_neighbour_edges);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 162, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_d_dc_long</span>(__pyx_t_1, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 162, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_neighbour_edges = __pyx_t_2;
  __pyx_t_2.memview = NULL;
  __pyx_t_2.data = NULL;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">163</span>: 	D.neighbour_edges = &amp;neighbour_edges[0,0]</pre>
<pre class='cython code score-0 '>  __pyx_t_3 = 0;
  __pyx_t_4 = 0;
  __pyx_v_D-&gt;neighbour_edges = (&amp;(*((long *) ( /* dim=1 */ ((char *) (((long *) ( /* dim=0 */ (__pyx_v_neighbour_edges.data + __pyx_t_3 * __pyx_v_neighbour_edges.strides[0]) )) + __pyx_t_4)) ))));
</pre><pre class="cython line score-0">&#xA0;<span class="">164</span>: </pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">165</span>: 	normals = domain_object.normals</pre>
<pre class='cython code score-5 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_domain_object, __pyx_n_s_normals);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 165, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_d_dc_double</span>(__pyx_t_1, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_5.memview)) __PYX_ERR(0, 165, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_normals = __pyx_t_5;
  __pyx_t_5.memview = NULL;
  __pyx_t_5.data = NULL;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">166</span>: 	D.normals = &amp;normals[0,0]</pre>
<pre class='cython code score-0 '>  __pyx_t_4 = 0;
  __pyx_t_3 = 0;
  __pyx_v_D-&gt;normals = (&amp;(*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_normals.data + __pyx_t_4 * __pyx_v_normals.strides[0]) )) + __pyx_t_3)) ))));
</pre><pre class="cython line score-0">&#xA0;<span class="">167</span>: </pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">168</span>: 	edgelengths = domain_object.edgelengths</pre>
<pre class='cython code score-5 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_domain_object, __pyx_n_s_edgelengths);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 168, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_d_dc_double</span>(__pyx_t_1, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_5.memview)) __PYX_ERR(0, 168, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_edgelengths = __pyx_t_5;
  __pyx_t_5.memview = NULL;
  __pyx_t_5.data = NULL;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">169</span>: 	D.edgelengths = &amp;edgelengths[0,0]</pre>
<pre class='cython code score-0 '>  __pyx_t_3 = 0;
  __pyx_t_4 = 0;
  __pyx_v_D-&gt;edgelengths = (&amp;(*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_edgelengths.data + __pyx_t_3 * __pyx_v_edgelengths.strides[0]) )) + __pyx_t_4)) ))));
</pre><pre class="cython line score-0">&#xA0;<span class="">170</span>: </pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">171</span>: 	radii = domain_object.radii</pre>
<pre class='cython code score-5 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_domain_object, __pyx_n_s_radii);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 171, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dc_double</span>(__pyx_t_1, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(0, 171, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_radii = __pyx_t_6;
  __pyx_t_6.memview = NULL;
  __pyx_t_6.data = NULL;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">172</span>: 	D.radii = &amp;radii[0]</pre>
<pre class='cython code score-0 '>  __pyx_t_4 = 0;
  __pyx_v_D-&gt;radii = (&amp;(*((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_radii.data) + __pyx_t_4)) ))));
</pre><pre class="cython line score-0">&#xA0;<span class="">173</span>: </pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">174</span>: 	areas = domain_object.areas</pre>
<pre class='cython code score-5 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_domain_object, __pyx_n_s_areas);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 174, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dc_double</span>(__pyx_t_1, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(0, 174, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_areas = __pyx_t_6;
  __pyx_t_6.memview = NULL;
  __pyx_t_6.data = NULL;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">175</span>: 	D.areas = &amp;areas[0]</pre>
<pre class='cython code score-0 '>  __pyx_t_4 = 0;
  __pyx_v_D-&gt;areas = (&amp;(*((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_areas.data) + __pyx_t_4)) ))));
</pre><pre class="cython line score-0">&#xA0;<span class="">176</span>: </pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">177</span>: 	edge_flux_type = domain_object.edge_flux_type</pre>
<pre class='cython code score-5 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_domain_object, __pyx_n_s_edge_flux_type);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 177, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dc_long</span>(__pyx_t_1, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_7.memview)) __PYX_ERR(0, 177, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_edge_flux_type = __pyx_t_7;
  __pyx_t_7.memview = NULL;
  __pyx_t_7.data = NULL;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">178</span>: 	D.edge_flux_type = &amp;edge_flux_type[0]</pre>
<pre class='cython code score-0 '>  __pyx_t_4 = 0;
  __pyx_v_D-&gt;edge_flux_type = (&amp;(*((long *) ( /* dim=0 */ ((char *) (((long *) __pyx_v_edge_flux_type.data) + __pyx_t_4)) ))));
</pre><pre class="cython line score-0">&#xA0;<span class="">179</span>: </pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">180</span>: 	tri_full_flag = domain_object.tri_full_flag</pre>
<pre class='cython code score-5 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_domain_object, __pyx_n_s_tri_full_flag);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 180, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dc_long</span>(__pyx_t_1, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_7.memview)) __PYX_ERR(0, 180, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_tri_full_flag = __pyx_t_7;
  __pyx_t_7.memview = NULL;
  __pyx_t_7.data = NULL;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">181</span>: 	D.tri_full_flag = &amp;tri_full_flag[0]</pre>
<pre class='cython code score-0 '>  __pyx_t_4 = 0;
  __pyx_v_D-&gt;tri_full_flag = (&amp;(*((long *) ( /* dim=0 */ ((char *) (((long *) __pyx_v_tri_full_flag.data) + __pyx_t_4)) ))));
</pre><pre class="cython line score-0">&#xA0;<span class="">182</span>: </pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">183</span>: 	already_computed_flux = domain_object.already_computed_flux</pre>
<pre class='cython code score-5 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_domain_object, __pyx_n_s_already_computed_flux);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 183, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_d_dc_long</span>(__pyx_t_1, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_2.memview)) __PYX_ERR(0, 183, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_already_computed_flux = __pyx_t_2;
  __pyx_t_2.memview = NULL;
  __pyx_t_2.data = NULL;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">184</span>: 	D.already_computed_flux = &amp;already_computed_flux[0,0]</pre>
<pre class='cython code score-0 '>  __pyx_t_4 = 0;
  __pyx_t_3 = 0;
  __pyx_v_D-&gt;already_computed_flux = (&amp;(*((long *) ( /* dim=1 */ ((char *) (((long *) ( /* dim=0 */ (__pyx_v_already_computed_flux.data + __pyx_t_4 * __pyx_v_already_computed_flux.strides[0]) )) + __pyx_t_3)) ))));
</pre><pre class="cython line score-0">&#xA0;<span class="">185</span>: </pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">186</span>: 	vertex_coordinates = domain_object.vertex_coordinates</pre>
<pre class='cython code score-5 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_domain_object, __pyx_n_s_vertex_coordinates);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 186, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_d_dc_double</span>(__pyx_t_1, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_5.memview)) __PYX_ERR(0, 186, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_vertex_coordinates = __pyx_t_5;
  __pyx_t_5.memview = NULL;
  __pyx_t_5.data = NULL;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">187</span>: 	D.vertex_coordinates = &amp;vertex_coordinates[0,0]</pre>
<pre class='cython code score-0 '>  __pyx_t_3 = 0;
  __pyx_t_4 = 0;
  __pyx_v_D-&gt;vertex_coordinates = (&amp;(*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_vertex_coordinates.data + __pyx_t_3 * __pyx_v_vertex_coordinates.strides[0]) )) + __pyx_t_4)) ))));
</pre><pre class="cython line score-0">&#xA0;<span class="">188</span>: </pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">189</span>: 	edge_coordinates = domain_object.edge_coordinates</pre>
<pre class='cython code score-5 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_domain_object, __pyx_n_s_edge_coordinates);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 189, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_d_dc_double</span>(__pyx_t_1, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_5.memview)) __PYX_ERR(0, 189, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_edge_coordinates = __pyx_t_5;
  __pyx_t_5.memview = NULL;
  __pyx_t_5.data = NULL;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">190</span>: 	D.edge_coordinates = &amp;edge_coordinates[0,0]</pre>
<pre class='cython code score-0 '>  __pyx_t_4 = 0;
  __pyx_t_3 = 0;
  __pyx_v_D-&gt;edge_coordinates = (&amp;(*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_edge_coordinates.data + __pyx_t_4 * __pyx_v_edge_coordinates.strides[0]) )) + __pyx_t_3)) ))));
</pre><pre class="cython line score-0">&#xA0;<span class="">191</span>: </pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">192</span>: 	centroid_coordinates = domain_object.centroid_coordinates</pre>
<pre class='cython code score-5 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_domain_object, __pyx_n_s_centroid_coordinates);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 192, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_d_dc_double</span>(__pyx_t_1, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_5.memview)) __PYX_ERR(0, 192, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_centroid_coordinates = __pyx_t_5;
  __pyx_t_5.memview = NULL;
  __pyx_t_5.data = NULL;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">193</span>: 	D.centroid_coordinates = &amp;centroid_coordinates[0,0]</pre>
<pre class='cython code score-0 '>  __pyx_t_3 = 0;
  __pyx_t_4 = 0;
  __pyx_v_D-&gt;centroid_coordinates = (&amp;(*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_centroid_coordinates.data + __pyx_t_3 * __pyx_v_centroid_coordinates.strides[0]) )) + __pyx_t_4)) ))));
</pre><pre class="cython line score-0">&#xA0;<span class="">194</span>: </pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">195</span>: 	max_speed = domain_object.max_speed</pre>
<pre class='cython code score-5 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_domain_object, __pyx_n_s_max_speed);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 195, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dc_double</span>(__pyx_t_1, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(0, 195, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_max_speed = __pyx_t_6;
  __pyx_t_6.memview = NULL;
  __pyx_t_6.data = NULL;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">196</span>: 	D.max_speed = &amp;max_speed[0]</pre>
<pre class='cython code score-0 '>  __pyx_t_4 = 0;
  __pyx_v_D-&gt;max_speed = (&amp;(*((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_max_speed.data) + __pyx_t_4)) ))));
</pre><pre class="cython line score-0">&#xA0;<span class="">197</span>: </pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">198</span>: 	number_of_boundaries = domain_object.number_of_boundaries</pre>
<pre class='cython code score-5 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_domain_object, __pyx_n_s_number_of_boundaries);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 198, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dc_long</span>(__pyx_t_1, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_7.memview)) __PYX_ERR(0, 198, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_number_of_boundaries = __pyx_t_7;
  __pyx_t_7.memview = NULL;
  __pyx_t_7.data = NULL;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">199</span>: 	D.number_of_boundaries = &amp;number_of_boundaries[0]</pre>
<pre class='cython code score-0 '>  __pyx_t_4 = 0;
  __pyx_v_D-&gt;number_of_boundaries = (&amp;(*((long *) ( /* dim=0 */ ((char *) (((long *) __pyx_v_number_of_boundaries.data) + __pyx_t_4)) ))));
</pre><pre class="cython line score-0">&#xA0;<span class="">200</span>: </pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">201</span>: 	flux_update_frequency = domain_object.flux_update_frequency</pre>
<pre class='cython code score-5 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_domain_object, __pyx_n_s_flux_update_frequency);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 201, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dc_long</span>(__pyx_t_1, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_7.memview)) __PYX_ERR(0, 201, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_flux_update_frequency = __pyx_t_7;
  __pyx_t_7.memview = NULL;
  __pyx_t_7.data = NULL;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">202</span>: 	D.flux_update_frequency = &amp;flux_update_frequency[0]</pre>
<pre class='cython code score-0 '>  __pyx_t_4 = 0;
  __pyx_v_D-&gt;flux_update_frequency = (&amp;(*((long *) ( /* dim=0 */ ((char *) (((long *) __pyx_v_flux_update_frequency.data) + __pyx_t_4)) ))));
</pre><pre class="cython line score-0">&#xA0;<span class="">203</span>: </pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">204</span>: 	update_next_flux = domain_object.update_next_flux</pre>
<pre class='cython code score-5 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_domain_object, __pyx_n_s_update_next_flux);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 204, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dc_long</span>(__pyx_t_1, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_7.memview)) __PYX_ERR(0, 204, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_update_next_flux = __pyx_t_7;
  __pyx_t_7.memview = NULL;
  __pyx_t_7.data = NULL;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">205</span>: 	D.update_next_flux = &amp;update_next_flux[0]</pre>
<pre class='cython code score-0 '>  __pyx_t_4 = 0;
  __pyx_v_D-&gt;update_next_flux = (&amp;(*((long *) ( /* dim=0 */ ((char *) (((long *) __pyx_v_update_next_flux.data) + __pyx_t_4)) ))));
</pre><pre class="cython line score-0">&#xA0;<span class="">206</span>: </pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">207</span>: 	update_extrapolation = domain_object.update_extrapolation</pre>
<pre class='cython code score-5 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_domain_object, __pyx_n_s_update_extrapolation);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 207, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dc_long</span>(__pyx_t_1, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_7.memview)) __PYX_ERR(0, 207, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_update_extrapolation = __pyx_t_7;
  __pyx_t_7.memview = NULL;
  __pyx_t_7.data = NULL;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">208</span>: 	D.update_extrapolation = &amp;update_extrapolation[0]</pre>
<pre class='cython code score-0 '>  __pyx_t_4 = 0;
  __pyx_v_D-&gt;update_extrapolation = (&amp;(*((long *) ( /* dim=0 */ ((char *) (((long *) __pyx_v_update_extrapolation.data) + __pyx_t_4)) ))));
</pre><pre class="cython line score-0">&#xA0;<span class="">209</span>: </pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">210</span>: 	allow_timestep_increase = domain_object.allow_timestep_increase</pre>
<pre class='cython code score-5 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_domain_object, __pyx_n_s_allow_timestep_increase);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 210, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dc_long</span>(__pyx_t_1, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_7.memview)) __PYX_ERR(0, 210, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_allow_timestep_increase = __pyx_t_7;
  __pyx_t_7.memview = NULL;
  __pyx_t_7.data = NULL;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">211</span>: 	D.allow_timestep_increase = &amp;allow_timestep_increase[0]</pre>
<pre class='cython code score-0 '>  __pyx_t_4 = 0;
  __pyx_v_D-&gt;allow_timestep_increase = (&amp;(*((long *) ( /* dim=0 */ ((char *) (((long *) __pyx_v_allow_timestep_increase.data) + __pyx_t_4)) ))));
</pre><pre class="cython line score-0">&#xA0;<span class="">212</span>: </pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">213</span>: 	edge_timestep = domain_object.edge_timestep</pre>
<pre class='cython code score-5 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_domain_object, __pyx_n_s_edge_timestep);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 213, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dc_double</span>(__pyx_t_1, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(0, 213, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_edge_timestep = __pyx_t_6;
  __pyx_t_6.memview = NULL;
  __pyx_t_6.data = NULL;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">214</span>: 	D.edge_timestep = &amp;edge_timestep[0]</pre>
<pre class='cython code score-0 '>  __pyx_t_4 = 0;
  __pyx_v_D-&gt;edge_timestep = (&amp;(*((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_edge_timestep.data) + __pyx_t_4)) ))));
</pre><pre class="cython line score-0">&#xA0;<span class="">215</span>: </pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">216</span>: 	edge_flux_work = domain_object.edge_flux_work</pre>
<pre class='cython code score-5 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_domain_object, __pyx_n_s_edge_flux_work);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 216, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dc_double</span>(__pyx_t_1, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(0, 216, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_edge_flux_work = __pyx_t_6;
  __pyx_t_6.memview = NULL;
  __pyx_t_6.data = NULL;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">217</span>: 	D.edge_flux_work = &amp;edge_flux_work[0]</pre>
<pre class='cython code score-0 '>  __pyx_t_4 = 0;
  __pyx_v_D-&gt;edge_flux_work = (&amp;(*((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_edge_flux_work.data) + __pyx_t_4)) ))));
</pre><pre class="cython line score-0">&#xA0;<span class="">218</span>: </pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">219</span>: 	pressuregrad_work = domain_object.pressuregrad_work</pre>
<pre class='cython code score-5 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_domain_object, __pyx_n_s_pressuregrad_work);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 219, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dc_double</span>(__pyx_t_1, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(0, 219, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_pressuregrad_work = __pyx_t_6;
  __pyx_t_6.memview = NULL;
  __pyx_t_6.data = NULL;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">220</span>: 	D.pressuregrad_work = &amp;pressuregrad_work[0]</pre>
<pre class='cython code score-0 '>  __pyx_t_4 = 0;
  __pyx_v_D-&gt;pressuregrad_work = (&amp;(*((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_pressuregrad_work.data) + __pyx_t_4)) ))));
</pre><pre class="cython line score-0">&#xA0;<span class="">221</span>: </pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">222</span>: 	x_centroid_work = domain_object.x_centroid_work</pre>
<pre class='cython code score-5 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_domain_object, __pyx_n_s_x_centroid_work);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 222, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dc_double</span>(__pyx_t_1, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(0, 222, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_x_centroid_work = __pyx_t_6;
  __pyx_t_6.memview = NULL;
  __pyx_t_6.data = NULL;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">223</span>: 	D.x_centroid_work = &amp;x_centroid_work[0]</pre>
<pre class='cython code score-0 '>  __pyx_t_4 = 0;
  __pyx_v_D-&gt;x_centroid_work = (&amp;(*((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_x_centroid_work.data) + __pyx_t_4)) ))));
</pre><pre class="cython line score-0">&#xA0;<span class="">224</span>: </pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">225</span>: 	y_centroid_work = domain_object.y_centroid_work</pre>
<pre class='cython code score-5 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_domain_object, __pyx_n_s_y_centroid_work);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 225, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dc_double</span>(__pyx_t_1, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(0, 225, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_y_centroid_work = __pyx_t_6;
  __pyx_t_6.memview = NULL;
  __pyx_t_6.data = NULL;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">226</span>: 	D.y_centroid_work = &amp;y_centroid_work[0]</pre>
<pre class='cython code score-0 '>  __pyx_t_4 = 0;
  __pyx_v_D-&gt;y_centroid_work = (&amp;(*((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_y_centroid_work.data) + __pyx_t_4)) ))));
</pre><pre class="cython line score-0">&#xA0;<span class="">227</span>: </pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">228</span>: 	boundary_flux_sum = domain_object.boundary_flux_sum</pre>
<pre class='cython code score-5 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_domain_object, __pyx_n_s_boundary_flux_sum);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 228, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dc_double</span>(__pyx_t_1, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(0, 228, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_boundary_flux_sum = __pyx_t_6;
  __pyx_t_6.memview = NULL;
  __pyx_t_6.data = NULL;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">229</span>: 	D.boundary_flux_sum = &amp;boundary_flux_sum[0]</pre>
<pre class='cython code score-0 '>  __pyx_t_4 = 0;
  __pyx_v_D-&gt;boundary_flux_sum = (&amp;(*((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_boundary_flux_sum.data) + __pyx_t_4)) ))));
</pre><pre class="cython line score-0">&#xA0;<span class="">230</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">231</span>: 	#------------------------------------------------------</pre>
<pre class="cython line score-0">&#xA0;<span class="">232</span>: 	# Quantity structures</pre>
<pre class="cython line score-0">&#xA0;<span class="">233</span>: 	#------------------------------------------------------</pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">234</span>: 	quantities = domain_object.quantities</pre>
<pre class='cython code score-2 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_domain_object, __pyx_n_s_quantities);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 234, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_v_quantities = __pyx_t_1;
  __pyx_t_1 = 0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">235</span>: 	stage = quantities["stage"]</pre>
<pre class='cython code score-2 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Dict_GetItem</span>(__pyx_v_quantities, __pyx_n_s_stage);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 235, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_v_stage = __pyx_t_1;
  __pyx_t_1 = 0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">236</span>: 	xmomentum = quantities["xmomentum"]</pre>
<pre class='cython code score-2 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Dict_GetItem</span>(__pyx_v_quantities, __pyx_n_s_xmomentum);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 236, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_v_xmomentum = __pyx_t_1;
  __pyx_t_1 = 0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">237</span>: 	ymomentum = quantities["ymomentum"]</pre>
<pre class='cython code score-2 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Dict_GetItem</span>(__pyx_v_quantities, __pyx_n_s_ymomentum);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 237, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_v_ymomentum = __pyx_t_1;
  __pyx_t_1 = 0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">238</span>: 	elevation = quantities["elevation"]</pre>
<pre class='cython code score-2 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Dict_GetItem</span>(__pyx_v_quantities, __pyx_n_s_elevation);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 238, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_v_elevation = __pyx_t_1;
  __pyx_t_1 = 0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">239</span>: 	height = quantities["height"]</pre>
<pre class='cython code score-2 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Dict_GetItem</span>(__pyx_v_quantities, __pyx_n_s_height);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 239, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_v_height = __pyx_t_1;
  __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">240</span>: </pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">241</span>: 	edge_values = stage.edge_values</pre>
<pre class='cython code score-5 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_stage, __pyx_n_s_edge_values);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 241, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_d_dc_double</span>(__pyx_t_1, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_5.memview)) __PYX_ERR(0, 241, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_edge_values = __pyx_t_5;
  __pyx_t_5.memview = NULL;
  __pyx_t_5.data = NULL;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">242</span>: 	D.stage_edge_values = &amp;edge_values[0,0]</pre>
<pre class='cython code score-0 '>  __pyx_t_4 = 0;
  __pyx_t_3 = 0;
  __pyx_v_D-&gt;stage_edge_values = (&amp;(*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_edge_values.data + __pyx_t_4 * __pyx_v_edge_values.strides[0]) )) + __pyx_t_3)) ))));
</pre><pre class="cython line score-0">&#xA0;<span class="">243</span>: </pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">244</span>: 	edge_values = xmomentum.edge_values</pre>
<pre class='cython code score-5 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_xmomentum, __pyx_n_s_edge_values);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 244, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_d_dc_double</span>(__pyx_t_1, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_5.memview)) __PYX_ERR(0, 244, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_edge_values, 1);
  __pyx_v_edge_values = __pyx_t_5;
  __pyx_t_5.memview = NULL;
  __pyx_t_5.data = NULL;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">245</span>: 	D.xmom_edge_values = &amp;edge_values[0,0]</pre>
<pre class='cython code score-0 '>  __pyx_t_3 = 0;
  __pyx_t_4 = 0;
  __pyx_v_D-&gt;xmom_edge_values = (&amp;(*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_edge_values.data + __pyx_t_3 * __pyx_v_edge_values.strides[0]) )) + __pyx_t_4)) ))));
</pre><pre class="cython line score-0">&#xA0;<span class="">246</span>: </pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">247</span>: 	edge_values = ymomentum.edge_values</pre>
<pre class='cython code score-5 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_ymomentum, __pyx_n_s_edge_values);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 247, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_d_dc_double</span>(__pyx_t_1, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_5.memview)) __PYX_ERR(0, 247, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_edge_values, 1);
  __pyx_v_edge_values = __pyx_t_5;
  __pyx_t_5.memview = NULL;
  __pyx_t_5.data = NULL;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">248</span>: 	D.ymom_edge_values = &amp;edge_values[0,0]</pre>
<pre class='cython code score-0 '>  __pyx_t_4 = 0;
  __pyx_t_3 = 0;
  __pyx_v_D-&gt;ymom_edge_values = (&amp;(*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_edge_values.data + __pyx_t_4 * __pyx_v_edge_values.strides[0]) )) + __pyx_t_3)) ))));
</pre><pre class="cython line score-0">&#xA0;<span class="">249</span>: </pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">250</span>: 	edge_values = elevation.edge_values</pre>
<pre class='cython code score-5 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_elevation, __pyx_n_s_edge_values);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 250, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_d_dc_double</span>(__pyx_t_1, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_5.memview)) __PYX_ERR(0, 250, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_edge_values, 1);
  __pyx_v_edge_values = __pyx_t_5;
  __pyx_t_5.memview = NULL;
  __pyx_t_5.data = NULL;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">251</span>: 	D.bed_edge_values = &amp;edge_values[0,0]</pre>
<pre class='cython code score-0 '>  __pyx_t_3 = 0;
  __pyx_t_4 = 0;
  __pyx_v_D-&gt;bed_edge_values = (&amp;(*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_edge_values.data + __pyx_t_3 * __pyx_v_edge_values.strides[0]) )) + __pyx_t_4)) ))));
</pre><pre class="cython line score-0">&#xA0;<span class="">252</span>: </pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">253</span>: 	edge_values = height.edge_values</pre>
<pre class='cython code score-5 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_height, __pyx_n_s_edge_values);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 253, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_d_dc_double</span>(__pyx_t_1, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_5.memview)) __PYX_ERR(0, 253, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_edge_values, 1);
  __pyx_v_edge_values = __pyx_t_5;
  __pyx_t_5.memview = NULL;
  __pyx_t_5.data = NULL;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">254</span>: 	D.height_edge_values = &amp;edge_values[0,0]</pre>
<pre class='cython code score-0 '>  __pyx_t_4 = 0;
  __pyx_t_3 = 0;
  __pyx_v_D-&gt;height_edge_values = (&amp;(*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_edge_values.data + __pyx_t_4 * __pyx_v_edge_values.strides[0]) )) + __pyx_t_3)) ))));
</pre><pre class="cython line score-0">&#xA0;<span class="">255</span>: </pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">256</span>: 	centroid_values = stage.centroid_values</pre>
<pre class='cython code score-5 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_stage, __pyx_n_s_centroid_values);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 256, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dc_double</span>(__pyx_t_1, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(0, 256, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_centroid_values = __pyx_t_6;
  __pyx_t_6.memview = NULL;
  __pyx_t_6.data = NULL;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">257</span>: 	D.stage_centroid_values = &amp;centroid_values[0]</pre>
<pre class='cython code score-0 '>  __pyx_t_3 = 0;
  __pyx_v_D-&gt;stage_centroid_values = (&amp;(*((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_centroid_values.data) + __pyx_t_3)) ))));
</pre><pre class="cython line score-0">&#xA0;<span class="">258</span>: </pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">259</span>: 	centroid_values = xmomentum.centroid_values</pre>
<pre class='cython code score-5 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_xmomentum, __pyx_n_s_centroid_values);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 259, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dc_double</span>(__pyx_t_1, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(0, 259, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_centroid_values, 1);
  __pyx_v_centroid_values = __pyx_t_6;
  __pyx_t_6.memview = NULL;
  __pyx_t_6.data = NULL;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">260</span>: 	D.xmom_centroid_values = &amp;centroid_values[0]</pre>
<pre class='cython code score-0 '>  __pyx_t_3 = 0;
  __pyx_v_D-&gt;xmom_centroid_values = (&amp;(*((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_centroid_values.data) + __pyx_t_3)) ))));
</pre><pre class="cython line score-0">&#xA0;<span class="">261</span>: </pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">262</span>: 	centroid_values = ymomentum.centroid_values</pre>
<pre class='cython code score-5 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_ymomentum, __pyx_n_s_centroid_values);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 262, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dc_double</span>(__pyx_t_1, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(0, 262, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_centroid_values, 1);
  __pyx_v_centroid_values = __pyx_t_6;
  __pyx_t_6.memview = NULL;
  __pyx_t_6.data = NULL;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">263</span>: 	D.ymom_centroid_values = &amp;centroid_values[0]</pre>
<pre class='cython code score-0 '>  __pyx_t_3 = 0;
  __pyx_v_D-&gt;ymom_centroid_values = (&amp;(*((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_centroid_values.data) + __pyx_t_3)) ))));
</pre><pre class="cython line score-0">&#xA0;<span class="">264</span>: </pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">265</span>: 	centroid_values = elevation.centroid_values</pre>
<pre class='cython code score-5 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_elevation, __pyx_n_s_centroid_values);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 265, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dc_double</span>(__pyx_t_1, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(0, 265, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_centroid_values, 1);
  __pyx_v_centroid_values = __pyx_t_6;
  __pyx_t_6.memview = NULL;
  __pyx_t_6.data = NULL;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">266</span>: 	D.bed_centroid_values = &amp;centroid_values[0]</pre>
<pre class='cython code score-0 '>  __pyx_t_3 = 0;
  __pyx_v_D-&gt;bed_centroid_values = (&amp;(*((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_centroid_values.data) + __pyx_t_3)) ))));
</pre><pre class="cython line score-0">&#xA0;<span class="">267</span>: </pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">268</span>: 	centroid_values = height.centroid_values</pre>
<pre class='cython code score-5 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_height, __pyx_n_s_centroid_values);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 268, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dc_double</span>(__pyx_t_1, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(0, 268, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_centroid_values, 1);
  __pyx_v_centroid_values = __pyx_t_6;
  __pyx_t_6.memview = NULL;
  __pyx_t_6.data = NULL;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">269</span>: 	D.height_centroid_values = &amp;centroid_values[0]</pre>
<pre class='cython code score-0 '>  __pyx_t_3 = 0;
  __pyx_v_D-&gt;height_centroid_values = (&amp;(*((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_centroid_values.data) + __pyx_t_3)) ))));
</pre><pre class="cython line score-0">&#xA0;<span class="">270</span>: </pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">271</span>: 	vertex_values = stage.vertex_values</pre>
<pre class='cython code score-5 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_stage, __pyx_n_s_vertex_values);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 271, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_d_dc_double</span>(__pyx_t_1, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_5.memview)) __PYX_ERR(0, 271, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_vertex_values = __pyx_t_5;
  __pyx_t_5.memview = NULL;
  __pyx_t_5.data = NULL;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">272</span>: 	D.stage_vertex_values = &amp;vertex_values[0,0]</pre>
<pre class='cython code score-0 '>  __pyx_t_3 = 0;
  __pyx_t_4 = 0;
  __pyx_v_D-&gt;stage_vertex_values = (&amp;(*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_vertex_values.data + __pyx_t_3 * __pyx_v_vertex_values.strides[0]) )) + __pyx_t_4)) ))));
</pre><pre class="cython line score-0">&#xA0;<span class="">273</span>: </pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">274</span>: 	vertex_values = xmomentum.vertex_values</pre>
<pre class='cython code score-5 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_xmomentum, __pyx_n_s_vertex_values);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 274, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_d_dc_double</span>(__pyx_t_1, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_5.memview)) __PYX_ERR(0, 274, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_vertex_values, 1);
  __pyx_v_vertex_values = __pyx_t_5;
  __pyx_t_5.memview = NULL;
  __pyx_t_5.data = NULL;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">275</span>: 	D.xmom_vertex_values = &amp;vertex_values[0,0]</pre>
<pre class='cython code score-0 '>  __pyx_t_4 = 0;
  __pyx_t_3 = 0;
  __pyx_v_D-&gt;xmom_vertex_values = (&amp;(*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_vertex_values.data + __pyx_t_4 * __pyx_v_vertex_values.strides[0]) )) + __pyx_t_3)) ))));
</pre><pre class="cython line score-0">&#xA0;<span class="">276</span>: </pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">277</span>: 	vertex_values = ymomentum.vertex_values</pre>
<pre class='cython code score-5 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_ymomentum, __pyx_n_s_vertex_values);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 277, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_d_dc_double</span>(__pyx_t_1, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_5.memview)) __PYX_ERR(0, 277, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_vertex_values, 1);
  __pyx_v_vertex_values = __pyx_t_5;
  __pyx_t_5.memview = NULL;
  __pyx_t_5.data = NULL;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">278</span>: 	D.ymom_vertex_values = &amp;vertex_values[0,0]</pre>
<pre class='cython code score-0 '>  __pyx_t_3 = 0;
  __pyx_t_4 = 0;
  __pyx_v_D-&gt;ymom_vertex_values = (&amp;(*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_vertex_values.data + __pyx_t_3 * __pyx_v_vertex_values.strides[0]) )) + __pyx_t_4)) ))));
</pre><pre class="cython line score-0">&#xA0;<span class="">279</span>: </pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">280</span>: 	vertex_values = elevation.vertex_values</pre>
<pre class='cython code score-5 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_elevation, __pyx_n_s_vertex_values);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 280, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_d_dc_double</span>(__pyx_t_1, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_5.memview)) __PYX_ERR(0, 280, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_vertex_values, 1);
  __pyx_v_vertex_values = __pyx_t_5;
  __pyx_t_5.memview = NULL;
  __pyx_t_5.data = NULL;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">281</span>: 	D.bed_vertex_values = &amp;vertex_values[0,0]</pre>
<pre class='cython code score-0 '>  __pyx_t_4 = 0;
  __pyx_t_3 = 0;
  __pyx_v_D-&gt;bed_vertex_values = (&amp;(*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_vertex_values.data + __pyx_t_4 * __pyx_v_vertex_values.strides[0]) )) + __pyx_t_3)) ))));
</pre><pre class="cython line score-0">&#xA0;<span class="">282</span>: </pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">283</span>: 	vertex_values = height.vertex_values</pre>
<pre class='cython code score-5 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_height, __pyx_n_s_vertex_values);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 283, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_d_dc_double</span>(__pyx_t_1, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_5.memview)) __PYX_ERR(0, 283, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_vertex_values, 1);
  __pyx_v_vertex_values = __pyx_t_5;
  __pyx_t_5.memview = NULL;
  __pyx_t_5.data = NULL;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">284</span>: 	D.height_vertex_values = &amp;vertex_values[0,0]</pre>
<pre class='cython code score-0 '>  __pyx_t_3 = 0;
  __pyx_t_4 = 0;
  __pyx_v_D-&gt;height_vertex_values = (&amp;(*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_vertex_values.data + __pyx_t_3 * __pyx_v_vertex_values.strides[0]) )) + __pyx_t_4)) ))));
</pre><pre class="cython line score-0">&#xA0;<span class="">285</span>: </pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">286</span>: 	boundary_values = stage.boundary_values</pre>
<pre class='cython code score-5 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_stage, __pyx_n_s_boundary_values);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 286, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dc_double</span>(__pyx_t_1, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(0, 286, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_boundary_values = __pyx_t_6;
  __pyx_t_6.memview = NULL;
  __pyx_t_6.data = NULL;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">287</span>: 	D.stage_boundary_values = &amp;boundary_values[0]</pre>
<pre class='cython code score-0 '>  __pyx_t_4 = 0;
  __pyx_v_D-&gt;stage_boundary_values = (&amp;(*((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_boundary_values.data) + __pyx_t_4)) ))));
</pre><pre class="cython line score-0">&#xA0;<span class="">288</span>: </pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">289</span>: 	boundary_values = xmomentum.boundary_values</pre>
<pre class='cython code score-5 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_xmomentum, __pyx_n_s_boundary_values);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 289, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dc_double</span>(__pyx_t_1, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(0, 289, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_boundary_values, 1);
  __pyx_v_boundary_values = __pyx_t_6;
  __pyx_t_6.memview = NULL;
  __pyx_t_6.data = NULL;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">290</span>: 	D.xmom_boundary_values = &amp;boundary_values[0]</pre>
<pre class='cython code score-0 '>  __pyx_t_4 = 0;
  __pyx_v_D-&gt;xmom_boundary_values = (&amp;(*((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_boundary_values.data) + __pyx_t_4)) ))));
</pre><pre class="cython line score-0">&#xA0;<span class="">291</span>: </pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">292</span>: 	boundary_values = ymomentum.boundary_values</pre>
<pre class='cython code score-5 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_ymomentum, __pyx_n_s_boundary_values);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 292, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dc_double</span>(__pyx_t_1, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(0, 292, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_boundary_values, 1);
  __pyx_v_boundary_values = __pyx_t_6;
  __pyx_t_6.memview = NULL;
  __pyx_t_6.data = NULL;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">293</span>: 	D.ymom_boundary_values = &amp;boundary_values[0]</pre>
<pre class='cython code score-0 '>  __pyx_t_4 = 0;
  __pyx_v_D-&gt;ymom_boundary_values = (&amp;(*((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_boundary_values.data) + __pyx_t_4)) ))));
</pre><pre class="cython line score-0">&#xA0;<span class="">294</span>: </pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">295</span>: 	boundary_values = elevation.boundary_values</pre>
<pre class='cython code score-5 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_elevation, __pyx_n_s_boundary_values);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 295, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dc_double</span>(__pyx_t_1, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(0, 295, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_boundary_values, 1);
  __pyx_v_boundary_values = __pyx_t_6;
  __pyx_t_6.memview = NULL;
  __pyx_t_6.data = NULL;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">296</span>: 	D.bed_boundary_values = &amp;boundary_values[0]</pre>
<pre class='cython code score-0 '>  __pyx_t_4 = 0;
  __pyx_v_D-&gt;bed_boundary_values = (&amp;(*((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_boundary_values.data) + __pyx_t_4)) ))));
</pre><pre class="cython line score-0">&#xA0;<span class="">297</span>: </pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">298</span>: 	explicit_update = stage.explicit_update</pre>
<pre class='cython code score-5 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_stage, __pyx_n_s_explicit_update);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 298, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dc_double</span>(__pyx_t_1, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(0, 298, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_explicit_update = __pyx_t_6;
  __pyx_t_6.memview = NULL;
  __pyx_t_6.data = NULL;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">299</span>: 	D.stage_explicit_update = &amp;explicit_update[0]</pre>
<pre class='cython code score-0 '>  __pyx_t_4 = 0;
  __pyx_v_D-&gt;stage_explicit_update = (&amp;(*((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_explicit_update.data) + __pyx_t_4)) ))));
</pre><pre class="cython line score-0">&#xA0;<span class="">300</span>: </pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">301</span>: 	explicit_update = xmomentum.explicit_update</pre>
<pre class='cython code score-5 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_xmomentum, __pyx_n_s_explicit_update);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 301, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dc_double</span>(__pyx_t_1, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(0, 301, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_explicit_update, 1);
  __pyx_v_explicit_update = __pyx_t_6;
  __pyx_t_6.memview = NULL;
  __pyx_t_6.data = NULL;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">302</span>: 	D.xmom_explicit_update = &amp;explicit_update[0]</pre>
<pre class='cython code score-0 '>  __pyx_t_4 = 0;
  __pyx_v_D-&gt;xmom_explicit_update = (&amp;(*((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_explicit_update.data) + __pyx_t_4)) ))));
</pre><pre class="cython line score-0">&#xA0;<span class="">303</span>: </pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">304</span>: 	explicit_update = ymomentum.explicit_update</pre>
<pre class='cython code score-5 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_ymomentum, __pyx_n_s_explicit_update);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 304, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dc_double</span>(__pyx_t_1, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(0, 304, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __PYX_XDEC_MEMVIEW(&amp;__pyx_v_explicit_update, 1);
  __pyx_v_explicit_update = __pyx_t_6;
  __pyx_t_6.memview = NULL;
  __pyx_t_6.data = NULL;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">305</span>: 	D.ymom_explicit_update = &amp;explicit_update[0]</pre>
<pre class='cython code score-0 '>  __pyx_t_4 = 0;
  __pyx_v_D-&gt;ymom_explicit_update = (&amp;(*((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_explicit_update.data) + __pyx_t_4)) ))));
</pre><pre class="cython line score-0">&#xA0;<span class="">306</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">307</span>: 	#------------------------------------------------------</pre>
<pre class="cython line score-0">&#xA0;<span class="">308</span>: 	# Riverwall structures</pre>
<pre class="cython line score-0">&#xA0;<span class="">309</span>: 	#------------------------------------------------------</pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">310</span>: 	riverwallData = domain_object.riverwallData</pre>
<pre class='cython code score-2 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_domain_object, __pyx_n_s_riverwallData);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 310, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_v_riverwallData = __pyx_t_1;
  __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">311</span>: </pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">312</span>: 	riverwall_elevation = riverwallData.riverwall_elevation</pre>
<pre class='cython code score-5 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_riverwallData, __pyx_n_s_riverwall_elevation);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 312, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dc_double</span>(__pyx_t_1, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_6.memview)) __PYX_ERR(0, 312, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_riverwall_elevation = __pyx_t_6;
  __pyx_t_6.memview = NULL;
  __pyx_t_6.data = NULL;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">313</span>: 	D.riverwall_elevation = &amp;riverwall_elevation[0]</pre>
<pre class='cython code score-0 '>  __pyx_t_4 = 0;
  __pyx_v_D-&gt;riverwall_elevation = (&amp;(*((double *) ( /* dim=0 */ ((char *) (((double *) __pyx_v_riverwall_elevation.data) + __pyx_t_4)) ))));
</pre><pre class="cython line score-0">&#xA0;<span class="">314</span>: </pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">315</span>: 	riverwall_rowIndex = riverwallData.hydraulic_properties_rowIndex</pre>
<pre class='cython code score-5 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_riverwallData, __pyx_n_s_hydraulic_properties_rowIndex);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 315, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_dc_long</span>(__pyx_t_1, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_7.memview)) __PYX_ERR(0, 315, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_riverwall_rowIndex = __pyx_t_7;
  __pyx_t_7.memview = NULL;
  __pyx_t_7.data = NULL;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">316</span>: 	D.riverwall_rowIndex = &amp;riverwall_rowIndex[0]</pre>
<pre class='cython code score-0 '>  __pyx_t_4 = 0;
  __pyx_v_D-&gt;riverwall_rowIndex = (&amp;(*((long *) ( /* dim=0 */ ((char *) (((long *) __pyx_v_riverwall_rowIndex.data) + __pyx_t_4)) ))));
</pre><pre class="cython line score-0">&#xA0;<span class="">317</span>: </pre>
<pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">318</span>: 	D.ncol_riverwall_hydraulic_properties = riverwallData.ncol_hydraulic_properties</pre>
<pre class='cython code score-10 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_riverwallData, __pyx_n_s_ncol_hydraulic_properties);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 318, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyInt_As_long</span>(__pyx_t_1); if (unlikely((__pyx_t_8 == (long)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 318, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_D-&gt;ncol_riverwall_hydraulic_properties = __pyx_t_8;
</pre><pre class="cython line score-0">&#xA0;<span class="">319</span>: </pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">320</span>: 	riverwall_hydraulic_properties = riverwallData.hydraulic_properties</pre>
<pre class='cython code score-5 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_riverwallData, __pyx_n_s_hydraulic_properties);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 320, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_to_MemoryviewSlice_d_dc_double</span>(__pyx_t_1, PyBUF_WRITABLE);<span class='error_goto'> if (unlikely(!__pyx_t_5.memview)) __PYX_ERR(0, 320, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_riverwall_hydraulic_properties = __pyx_t_5;
  __pyx_t_5.memview = NULL;
  __pyx_t_5.data = NULL;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">321</span>: 	D.riverwall_hydraulic_properties = &amp;riverwall_hydraulic_properties[0,0]</pre>
<pre class='cython code score-0 '>  __pyx_t_4 = 0;
  __pyx_t_3 = 0;
  __pyx_v_D-&gt;riverwall_hydraulic_properties = (&amp;(*((double *) ( /* dim=1 */ ((char *) (((double *) ( /* dim=0 */ (__pyx_v_riverwall_hydraulic_properties.data + __pyx_t_4 * __pyx_v_riverwall_hydraulic_properties.strides[0]) )) + __pyx_t_3)) ))));
</pre><pre class="cython line score-0">&#xA0;<span class="">322</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">323</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">324</span>: #===============================================================================</pre>
<pre class="cython line score-0">&#xA0;<span class="">325</span>: </pre>
<pre class="cython line score-50" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">326</span>: def compute_fluxes_ext_central(object domain_object, double timestep):</pre>
<pre class='cython code score-50 '>/* Python wrapper */
static PyObject *__pyx_pw_5anuga_13shallow_water_16swDE1_domain_ext_1compute_fluxes_ext_central(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyMethodDef __pyx_mdef_5anuga_13shallow_water_16swDE1_domain_ext_1compute_fluxes_ext_central = {"compute_fluxes_ext_central", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_5anuga_13shallow_water_16swDE1_domain_ext_1compute_fluxes_ext_central, METH_VARARGS|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_5anuga_13shallow_water_16swDE1_domain_ext_1compute_fluxes_ext_central(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_domain_object = 0;
  double __pyx_v_timestep;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("compute_fluxes_ext_central (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_domain_object,&amp;__pyx_n_s_timestep,0};
    PyObject* values[2] = {0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_domain_object)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_timestep)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("compute_fluxes_ext_central", 1, 2, 2, 1); <span class='error_goto'>__PYX_ERR(0, 326, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "compute_fluxes_ext_central") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 326, __pyx_L3_error)</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 2) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
    }
    __pyx_v_domain_object = values[0];
    __pyx_v_timestep = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(values[1]); if (unlikely((__pyx_v_timestep == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 326, __pyx_L3_error)</span>
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("compute_fluxes_ext_central", 1, 2, 2, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>__PYX_ERR(0, 326, __pyx_L3_error)</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("anuga.shallow_water.swDE1_domain_ext.compute_fluxes_ext_central", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_5anuga_13shallow_water_16swDE1_domain_ext_compute_fluxes_ext_central(__pyx_self, __pyx_v_domain_object, __pyx_v_timestep);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_5anuga_13shallow_water_16swDE1_domain_ext_compute_fluxes_ext_central(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_domain_object, double __pyx_v_timestep) {
  struct domain __pyx_v_D;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("compute_fluxes_ext_central", 0);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("anuga.shallow_water.swDE1_domain_ext.compute_fluxes_ext_central", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_tuple__22 = <span class='py_c_api'>PyTuple_Pack</span>(3, __pyx_n_s_domain_object, __pyx_n_s_timestep, __pyx_n_s_D);<span class='error_goto'> if (unlikely(!__pyx_tuple__22)) __PYX_ERR(0, 326, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__22);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__22);
/* … */
  __pyx_t_1 = PyCFunction_NewEx(&amp;__pyx_mdef_5anuga_13shallow_water_16swDE1_domain_ext_1compute_fluxes_ext_central, NULL, __pyx_n_s_anuga_shallow_water_swDE1_domain_2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 326, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_compute_fluxes_ext_central, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 326, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_codeobj__23 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(2, 0, 3, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__22, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_anuga_shallow_water_swDE1_domain, __pyx_n_s_compute_fluxes_ext_central, 326, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__23)) __PYX_ERR(0, 326, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">327</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">328</span>: 	cdef domain D</pre>
<pre class="cython line score-0">&#xA0;<span class="">329</span>: </pre>
<pre class="cython line score-1" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">330</span>: 	get_python_domain_parameters(&amp;D, domain_object)</pre>
<pre class='cython code score-1 '>  __pyx_t_1 = __pyx_f_5anuga_13shallow_water_16swDE1_domain_ext_get_python_domain_parameters((&amp;__pyx_v_D), __pyx_v_domain_object);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 330, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-1" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">331</span>: 	get_python_domain_pointers(&amp;D, domain_object)</pre>
<pre class='cython code score-1 '>  __pyx_t_1 = __pyx_f_5anuga_13shallow_water_16swDE1_domain_ext_get_python_domain_pointers((&amp;__pyx_v_D), __pyx_v_domain_object);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 331, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">332</span>: </pre>
<pre class="cython line score-4" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">333</span>: 	with nogil:</pre>
<pre class='cython code score-4 '>  {
      #ifdef WITH_THREAD
      PyThreadState *_save;
      Py_UNBLOCK_THREADS
      <span class='pyx_c_api'>__Pyx_FastGIL_Remember</span>();
      #endif
      /*try:*/ {
/* … */
      /*finally:*/ {
        /*normal exit:*/{
          #ifdef WITH_THREAD
          <span class='pyx_c_api'>__Pyx_FastGIL_Forget</span>();
          Py_BLOCK_THREADS
          #endif
          goto __pyx_L5;
        }
        __pyx_L5:;
      }
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">334</span>: 		timestep = _compute_fluxes_central(&amp;D, timestep)</pre>
<pre class='cython code score-0 '>        __pyx_v_timestep = _compute_fluxes_central((&amp;__pyx_v_D), __pyx_v_timestep);
      }
</pre><pre class="cython line score-0">&#xA0;<span class="">335</span>: </pre>
<pre class="cython line score-6" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">336</span>: 	return timestep</pre>
<pre class='cython code score-6 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_timestep);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 336, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">337</span>: </pre>
<pre class="cython line score-17" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">338</span>: def extrapolate_second_order_edge_sw(object domain_object):</pre>
<pre class='cython code score-17 '>/* Python wrapper */
static PyObject *__pyx_pw_5anuga_13shallow_water_16swDE1_domain_ext_3extrapolate_second_order_edge_sw(PyObject *__pyx_self, PyObject *__pyx_v_domain_object); /*proto*/
static PyMethodDef __pyx_mdef_5anuga_13shallow_water_16swDE1_domain_ext_3extrapolate_second_order_edge_sw = {"extrapolate_second_order_edge_sw", (PyCFunction)__pyx_pw_5anuga_13shallow_water_16swDE1_domain_ext_3extrapolate_second_order_edge_sw, METH_O, 0};
static PyObject *__pyx_pw_5anuga_13shallow_water_16swDE1_domain_ext_3extrapolate_second_order_edge_sw(PyObject *__pyx_self, PyObject *__pyx_v_domain_object) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("extrapolate_second_order_edge_sw (wrapper)", 0);
  __pyx_r = __pyx_pf_5anuga_13shallow_water_16swDE1_domain_ext_2extrapolate_second_order_edge_sw(__pyx_self, ((PyObject *)__pyx_v_domain_object));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_5anuga_13shallow_water_16swDE1_domain_ext_2extrapolate_second_order_edge_sw(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_domain_object) {
  struct domain __pyx_v_D;
  int __pyx_v_e;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("extrapolate_second_order_edge_sw", 0);
/* … */
  /* function exit code */
  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("anuga.shallow_water.swDE1_domain_ext.extrapolate_second_order_edge_sw", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_tuple__24 = <span class='py_c_api'>PyTuple_Pack</span>(3, __pyx_n_s_domain_object, __pyx_n_s_D, __pyx_n_s_e);<span class='error_goto'> if (unlikely(!__pyx_tuple__24)) __PYX_ERR(0, 338, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__24);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__24);
/* … */
  __pyx_t_1 = PyCFunction_NewEx(&amp;__pyx_mdef_5anuga_13shallow_water_16swDE1_domain_ext_3extrapolate_second_order_edge_sw, NULL, __pyx_n_s_anuga_shallow_water_swDE1_domain_2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 338, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_extrapolate_second_order_edge_sw, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 338, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_codeobj__25 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(1, 0, 3, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__24, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_anuga_shallow_water_swDE1_domain, __pyx_n_s_extrapolate_second_order_edge_sw, 338, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__25)) __PYX_ERR(0, 338, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">339</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">340</span>: 	cdef domain D</pre>
<pre class="cython line score-0">&#xA0;<span class="">341</span>: 	cdef int e</pre>
<pre class="cython line score-0">&#xA0;<span class="">342</span>: </pre>
<pre class="cython line score-1" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">343</span>: 	get_python_domain_parameters(&amp;D, domain_object)</pre>
<pre class='cython code score-1 '>  __pyx_t_1 = __pyx_f_5anuga_13shallow_water_16swDE1_domain_ext_get_python_domain_parameters((&amp;__pyx_v_D), __pyx_v_domain_object);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 343, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-1" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">344</span>: 	get_python_domain_pointers(&amp;D, domain_object)</pre>
<pre class='cython code score-1 '>  __pyx_t_1 = __pyx_f_5anuga_13shallow_water_16swDE1_domain_ext_get_python_domain_pointers((&amp;__pyx_v_D), __pyx_v_domain_object);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 344, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">345</span>: </pre>
<pre class="cython line score-4" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">346</span>: 	with nogil:</pre>
<pre class='cython code score-4 '>  {
      #ifdef WITH_THREAD
      PyThreadState *_save;
      Py_UNBLOCK_THREADS
      <span class='pyx_c_api'>__Pyx_FastGIL_Remember</span>();
      #endif
      /*try:*/ {
/* … */
      /*finally:*/ {
        /*normal exit:*/{
          #ifdef WITH_THREAD
          <span class='pyx_c_api'>__Pyx_FastGIL_Forget</span>();
          Py_BLOCK_THREADS
          #endif
          goto __pyx_L5;
        }
        __pyx_L5:;
      }
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">347</span>: 		e = _extrapolate_second_order_edge_sw(&amp;D)</pre>
<pre class='cython code score-0 '>        __pyx_v_e = _extrapolate_second_order_edge_sw((&amp;__pyx_v_D));
      }
</pre><pre class="cython line score-0">&#xA0;<span class="">348</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">349</span>: 	if e == -1:</pre>
<pre class='cython code score-0 '>  __pyx_t_2 = ((__pyx_v_e == -1L) != 0);
  if (__pyx_t_2) {
/* … */
  }
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">350</span>: 		return None</pre>
<pre class='cython code score-2 '>    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
    __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
    goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">351</span>: </pre>
<pre class="cython line score-16" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">352</span>: def protect_new(object domain_object):</pre>
<pre class='cython code score-16 '>/* Python wrapper */
static PyObject *__pyx_pw_5anuga_13shallow_water_16swDE1_domain_ext_5protect_new(PyObject *__pyx_self, PyObject *__pyx_v_domain_object); /*proto*/
static PyMethodDef __pyx_mdef_5anuga_13shallow_water_16swDE1_domain_ext_5protect_new = {"protect_new", (PyCFunction)__pyx_pw_5anuga_13shallow_water_16swDE1_domain_ext_5protect_new, METH_O, 0};
static PyObject *__pyx_pw_5anuga_13shallow_water_16swDE1_domain_ext_5protect_new(PyObject *__pyx_self, PyObject *__pyx_v_domain_object) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("protect_new (wrapper)", 0);
  __pyx_r = __pyx_pf_5anuga_13shallow_water_16swDE1_domain_ext_4protect_new(__pyx_self, ((PyObject *)__pyx_v_domain_object));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_5anuga_13shallow_water_16swDE1_domain_ext_4protect_new(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_domain_object) {
  struct domain __pyx_v_D;
  double __pyx_v_mass_error;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("protect_new", 0);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("anuga.shallow_water.swDE1_domain_ext.protect_new", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_tuple__26 = <span class='py_c_api'>PyTuple_Pack</span>(3, __pyx_n_s_domain_object, __pyx_n_s_D, __pyx_n_s_mass_error);<span class='error_goto'> if (unlikely(!__pyx_tuple__26)) __PYX_ERR(0, 352, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__26);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__26);
/* … */
  __pyx_t_1 = PyCFunction_NewEx(&amp;__pyx_mdef_5anuga_13shallow_water_16swDE1_domain_ext_5protect_new, NULL, __pyx_n_s_anuga_shallow_water_swDE1_domain_2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 352, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_protect_new, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 352, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_codeobj__27 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(1, 0, 3, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__26, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_anuga_shallow_water_swDE1_domain, __pyx_n_s_protect_new, 352, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__27)) __PYX_ERR(0, 352, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">353</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">354</span>: 	cdef domain D</pre>
<pre class="cython line score-0">&#xA0;<span class="">355</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">356</span>: 	cdef double mass_error</pre>
<pre class="cython line score-0">&#xA0;<span class="">357</span>: </pre>
<pre class="cython line score-1" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">358</span>: 	get_python_domain_parameters(&amp;D, domain_object)</pre>
<pre class='cython code score-1 '>  __pyx_t_1 = __pyx_f_5anuga_13shallow_water_16swDE1_domain_ext_get_python_domain_parameters((&amp;__pyx_v_D), __pyx_v_domain_object);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 358, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-1" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">359</span>: 	get_python_domain_pointers(&amp;D, domain_object)</pre>
<pre class='cython code score-1 '>  __pyx_t_1 = __pyx_f_5anuga_13shallow_water_16swDE1_domain_ext_get_python_domain_pointers((&amp;__pyx_v_D), __pyx_v_domain_object);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 359, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">360</span>: </pre>
<pre class="cython line score-4" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">361</span>: 	with nogil:</pre>
<pre class='cython code score-4 '>  {
      #ifdef WITH_THREAD
      PyThreadState *_save;
      Py_UNBLOCK_THREADS
      <span class='pyx_c_api'>__Pyx_FastGIL_Remember</span>();
      #endif
      /*try:*/ {
/* … */
      /*finally:*/ {
        /*normal exit:*/{
          #ifdef WITH_THREAD
          <span class='pyx_c_api'>__Pyx_FastGIL_Forget</span>();
          Py_BLOCK_THREADS
          #endif
          goto __pyx_L5;
        }
        __pyx_L5:;
      }
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">362</span>: 		mass_error = _protect_new(&amp;D)</pre>
<pre class='cython code score-0 '>        __pyx_v_mass_error = _protect_new((&amp;__pyx_v_D));
      }
</pre><pre class="cython line score-0">&#xA0;<span class="">363</span>: </pre>
<pre class="cython line score-6" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">364</span>: 	return mass_error</pre>
<pre class='cython code score-6 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_mass_error);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 364, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">365</span>: </pre>
<pre class="cython line score-51" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">366</span>: def compute_flux_update_frequency(object domain_object, double timestep):</pre>
<pre class='cython code score-51 '>/* Python wrapper */
static PyObject *__pyx_pw_5anuga_13shallow_water_16swDE1_domain_ext_7compute_flux_update_frequency(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyMethodDef __pyx_mdef_5anuga_13shallow_water_16swDE1_domain_ext_7compute_flux_update_frequency = {"compute_flux_update_frequency", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_5anuga_13shallow_water_16swDE1_domain_ext_7compute_flux_update_frequency, METH_VARARGS|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_5anuga_13shallow_water_16swDE1_domain_ext_7compute_flux_update_frequency(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_domain_object = 0;
  double __pyx_v_timestep;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("compute_flux_update_frequency (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_domain_object,&amp;__pyx_n_s_timestep,0};
    PyObject* values[2] = {0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_domain_object)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_timestep)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("compute_flux_update_frequency", 1, 2, 2, 1); <span class='error_goto'>__PYX_ERR(0, 366, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "compute_flux_update_frequency") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 366, __pyx_L3_error)</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 2) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
    }
    __pyx_v_domain_object = values[0];
    __pyx_v_timestep = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(values[1]); if (unlikely((__pyx_v_timestep == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 366, __pyx_L3_error)</span>
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("compute_flux_update_frequency", 1, 2, 2, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>__PYX_ERR(0, 366, __pyx_L3_error)</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("anuga.shallow_water.swDE1_domain_ext.compute_flux_update_frequency", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_5anuga_13shallow_water_16swDE1_domain_ext_6compute_flux_update_frequency(__pyx_self, __pyx_v_domain_object, __pyx_v_timestep);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_5anuga_13shallow_water_16swDE1_domain_ext_6compute_flux_update_frequency(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_domain_object, double __pyx_v_timestep) {
  struct domain __pyx_v_D;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("compute_flux_update_frequency", 0);
/* … */
  /* function exit code */
  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("anuga.shallow_water.swDE1_domain_ext.compute_flux_update_frequency", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_tuple__28 = <span class='py_c_api'>PyTuple_Pack</span>(3, __pyx_n_s_domain_object, __pyx_n_s_timestep, __pyx_n_s_D);<span class='error_goto'> if (unlikely(!__pyx_tuple__28)) __PYX_ERR(0, 366, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__28);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__28);
/* … */
  __pyx_t_1 = PyCFunction_NewEx(&amp;__pyx_mdef_5anuga_13shallow_water_16swDE1_domain_ext_7compute_flux_update_frequency, NULL, __pyx_n_s_anuga_shallow_water_swDE1_domain_2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 366, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_compute_flux_update_frequency, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 366, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_codeobj__29 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(2, 0, 3, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__28, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_anuga_shallow_water_swDE1_domain, __pyx_n_s_compute_flux_update_frequency, 366, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__29)) __PYX_ERR(0, 366, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">367</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">368</span>: 	cdef domain D</pre>
<pre class="cython line score-0">&#xA0;<span class="">369</span>: </pre>
<pre class="cython line score-1" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">370</span>: 	get_python_domain_parameters(&amp;D, domain_object)</pre>
<pre class='cython code score-1 '>  __pyx_t_1 = __pyx_f_5anuga_13shallow_water_16swDE1_domain_ext_get_python_domain_parameters((&amp;__pyx_v_D), __pyx_v_domain_object);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 370, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-1" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">371</span>: 	get_python_domain_pointers(&amp;D, domain_object)</pre>
<pre class='cython code score-1 '>  __pyx_t_1 = __pyx_f_5anuga_13shallow_water_16swDE1_domain_ext_get_python_domain_pointers((&amp;__pyx_v_D), __pyx_v_domain_object);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 371, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">372</span>: </pre>
<pre class="cython line score-4" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">373</span>: 	with nogil:</pre>
<pre class='cython code score-4 '>  {
      #ifdef WITH_THREAD
      PyThreadState *_save;
      Py_UNBLOCK_THREADS
      <span class='pyx_c_api'>__Pyx_FastGIL_Remember</span>();
      #endif
      /*try:*/ {
/* … */
      /*finally:*/ {
        /*normal exit:*/{
          #ifdef WITH_THREAD
          <span class='pyx_c_api'>__Pyx_FastGIL_Forget</span>();
          Py_BLOCK_THREADS
          #endif
          goto __pyx_L5;
        }
        __pyx_L5:;
      }
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">374</span>: 		_compute_flux_update_frequency(&amp;D, timestep)</pre>
<pre class='cython code score-0 '>        (void)(_compute_flux_update_frequency((&amp;__pyx_v_D), __pyx_v_timestep));
      }
</pre><pre class="cython line score-0">&#xA0;<span class="">375</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">376</span>: </pre>
</div></body></html>
